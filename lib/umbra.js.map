{"version":3,"file":"umbra.js","sources":["../../umbra-test-runner/lib/Async/AsyncPromisifier.js","../../umbra-test-runner/lib/Async/TimeoutPromisifier.js","../../umbra-test-runner/lib/Config/TestRunnerConfig.js","../../umbra-test-runner/lib/Config/DefaultTestRunnerConfig.js","../../umbra-test-runner/lib/EventEmitter/SimpleEventEmitter.js","../../umbra-test-runner/lib/QueueStack.js","../../umbra-test-runner/lib/TestRunner.js","../../umbra-test-runner/lib/index.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/DeepEqual.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/ArrayUtils.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/SimpleEventEmitter.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/SortedArray.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/Stringify.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/ArgumentValidator.js","../../umbra-assert/node_modules/@umbra-test/umbra-util/lib/index.js","../../umbra-assert/lib/Assert.js","../../umbra-assert/lib/Expect.js","../../umbra-assert/lib/index.js","../../umbra-util/lib/DeepEqual.js","../../umbra-util/lib/ArrayUtils.js","../../umbra-util/lib/SimpleEventEmitter.js","../../umbra-util/lib/SortedArray.js","../../umbra-util/lib/Stringify.js","../../umbra-util/lib/ArgumentValidator.js","../../umbra-util/lib/index.js","../../umbra-mock/lib/Capture.js","../../umbra-mock/lib/InternalMocker.js","../../umbra-mock/lib/StackTraceParser.js","../../umbra-mock/lib/MockedFunction.js","../../umbra-mock/lib/Range.js","../../umbra-mock/lib/OnGoingStubs.js","../../umbra-mock/lib/Verify.js","../../umbra-mock/lib/UmbraTestRunnerIntegration.js","../../umbra-mock/lib/Mock.js","../../umbra-mock/lib/index.js","index.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.AsyncPromisifier = void 0;\r\n/**\r\n * A class that massages synchronous and some async functions into promises. Expects very specific function signatures.\r\n */\r\nclass AsyncPromisifier {\r\n    /**\r\n     * Takes a function and executes it as a Promise.\r\n     *\r\n     * Supports:\r\n     *  - Promises\r\n     *  - \"done\" callback\r\n     *  - sync returns\r\n     *\r\n     * @param {(done) => any} fn\r\n     * @returns {Promise<T>}\r\n     */\r\n    exec(fn, name) {\r\n        Object.defineProperty(fn, \"name\", { value: name, writable: false });\r\n        /*\r\n         * 2nd param is \"done\" -- if the user fn has exactly two params then it is expected that they are using a\r\n         * classic asynchronous function and will call \"done\" when complete.\r\n         */\r\n        if (fn.length === 1) {\r\n            return new Promise((resolve, reject) => {\r\n                fn((result) => {\r\n                    if (result instanceof Error) {\r\n                        reject(result);\r\n                    }\r\n                    else {\r\n                        resolve(result);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            try {\r\n                return Promise.resolve(fn());\r\n            }\r\n            catch (e) {\r\n                return Promise.reject(e);\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.AsyncPromisifier = AsyncPromisifier;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXN5bmNQcm9taXNpZmllci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Bc3luYy9Bc3luY1Byb21pc2lmaWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQVlBOztHQUVHO0FBQ0gsTUFBTSxnQkFBZ0I7SUFFbEI7Ozs7Ozs7Ozs7T0FVRztJQUNILElBQUksQ0FBSSxFQUEyRCxFQUFFLElBQVk7UUFFN0UsTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUNwRTs7O1dBR0c7UUFDSCxJQUFJLEVBQUUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2pCLE9BQU8sSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7Z0JBQ2YsRUFBRyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7b0JBQy9CLElBQUksTUFBTSxZQUFZLEtBQUssRUFBRTt3QkFDekIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO3FCQUNsQjt5QkFBTTt3QkFDSCxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7cUJBQ25CO2dCQUNMLENBQUMsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUM7U0FDTjthQUFNO1lBQ0gsSUFBSTtnQkFDQSxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQW9CLEVBQUcsRUFBRSxDQUFDLENBQUM7YUFDcEQ7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDUixPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDNUI7U0FDSjtJQUNMLENBQUM7Q0FDSjtBQUVRLDRDQUFnQiJ9","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TimeoutPromisifier = exports.TimeoutError = void 0;\r\n/**\r\n * Internal error type for differentiating timeouts from other promise failures.\r\n */\r\nclass TimeoutError extends Error {\r\n    constructor(message, elapsedMs, timeoutMs) {\r\n        super(message);\r\n        this.timeoutMs = timeoutMs;\r\n    }\r\n}\r\nexports.TimeoutError = TimeoutError;\r\n/**\r\n * A simple promise wrapper, which enables promises to \"timeout\". It does *NOT* actually manipulate or otherwise\r\n * interrupt long-running tasks, but rather simply ignores their result if they eventually do complete.\r\n */\r\nclass TimeoutPromisifier {\r\n    /**\r\n     * Wraps the Promise in another Promise, which will resolve/reject based on the former, or if a given amount of time\r\n     * has passed.\r\n     *\r\n     * @param promise\r\n     * @param timeoutMs\r\n     * @return A new promise, which will resolve if the given promise resolves, or reject if the timeout occurs first.\r\n     */\r\n    wrap(promise, timeoutMs) {\r\n        if (timeoutMs <= 0) {\r\n            return promise;\r\n        }\r\n        const startTime = Date.now();\r\n        let timerId = null;\r\n        const timeoutPromise = new Promise((resolve, reject) => {\r\n            timerId = setTimeout(() => {\r\n                const elapsedMs = Date.now() - startTime;\r\n                reject(new TimeoutError(`Async task timeout exceeded! Elapsed: ${elapsedMs}, timeout: ${timeoutMs}ms.`, elapsedMs, timeoutMs));\r\n            }, timeoutMs);\r\n        });\r\n        promise.catch(() => {\r\n            clearTimeout(timerId);\r\n        });\r\n        // timeoutPromise will never resolve, thus we can safely assume that the result is the original one.\r\n        return Promise.race([promise, timeoutPromise]).then((result) => {\r\n            clearTimeout(timerId);\r\n            return result;\r\n        });\r\n    }\r\n}\r\nexports.TimeoutPromisifier = TimeoutPromisifier;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGltZW91dFByb21pc2lmaWVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL0FzeW5jL1RpbWVvdXRQcm9taXNpZmllci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQTs7R0FFRztBQUNILE1BQU0sWUFBYSxTQUFRLEtBQUs7SUFJNUIsWUFBWSxPQUFlLEVBQUUsU0FBaUIsRUFBRSxTQUFpQjtRQUM3RCxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztJQUMvQixDQUFDO0NBQ0o7QUEyQ08sb0NBQVk7QUF6Q3BCOzs7R0FHRztBQUNILE1BQU0sa0JBQWtCO0lBRXBCOzs7Ozs7O09BT0c7SUFDSCxJQUFJLENBQUksT0FBbUIsRUFBRSxTQUFpQjtRQUMxQyxJQUFJLFNBQVMsSUFBSSxDQUFDLEVBQUU7WUFDaEIsT0FBTyxPQUFPLENBQUM7U0FDbEI7UUFFRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDN0IsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ25CLE1BQU0sY0FBYyxHQUFHLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ25ELE9BQU8sR0FBRyxVQUFVLENBQUMsR0FBRyxFQUFFO2dCQUN0QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFDO2dCQUN6QyxNQUFNLENBQUMsSUFBSSxZQUFZLENBQUMseUNBQXlDLFNBQVMsY0FBYyxTQUFTLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNuSSxDQUFDLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDbEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRTtZQUNmLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztRQUVILG9HQUFvRztRQUNwRyxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFlLEVBQUUsRUFBRTtZQUNwRSxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdEIsT0FBTyxNQUFXLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0NBRUo7QUFFcUIsZ0RBQWtCIn0=","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.mergeConfig = void 0;\r\n/**\r\n * A helper method to merge multiple sources of configuration.\r\n *\r\n * @param to - The base configuration object to be merged into.\r\n * @param from - The configuration object to merge from.\r\n */\r\nfunction mergeConfig(to, from) {\r\n    if (!from || typeof from !== \"object\") {\r\n        return to;\r\n    }\r\n    if (typeof to.timeoutMs === \"object\" && typeof from.timeoutMs === \"object\") {\r\n        for (const entryType of [\"it\", \"before\", \"beforeEach\", \"after\", \"afterEach\"]) {\r\n            if (typeof from.timeoutMs[entryType] === \"number\") {\r\n                to.timeoutMs[entryType] = from.timeoutMs[entryType];\r\n            }\r\n        }\r\n    }\r\n    else if (typeof from.timeoutMs !== \"undefined\") {\r\n        to.timeoutMs = from.timeoutMs;\r\n    }\r\n    if (to.stopOnFirstFail !== from.stopOnFirstFail) {\r\n        to.stopOnFirstFail = from.stopOnFirstFail;\r\n    }\r\n    return to;\r\n}\r\nexports.mergeConfig = mergeConfig;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJ1bm5lckNvbmZpZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Db25maWcvVGVzdFJ1bm5lckNvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFtQ0E7Ozs7O0dBS0c7QUFDSCxTQUFTLFdBQVcsQ0FBQyxFQUFvQixFQUFFLElBQWdDO0lBQ3ZFLElBQUksQ0FBQyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFO1FBQ25DLE9BQU8sRUFBRSxDQUFDO0tBQ2I7SUFFRCxJQUFJLE9BQU8sRUFBRSxDQUFDLFNBQVMsS0FBSyxRQUFRLElBQUksT0FBTyxJQUFJLENBQUMsU0FBUyxLQUFLLFFBQVEsRUFBRTtRQUN4RSxLQUFLLE1BQU0sU0FBUyxJQUFJLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxZQUFZLEVBQUUsT0FBTyxFQUFFLFdBQVcsQ0FBQyxFQUFFO1lBQzFFLElBQUksT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxLQUFLLFFBQVEsRUFBRTtnQkFDL0MsRUFBRSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2FBQ3ZEO1NBQ0o7S0FDSjtTQUFNLElBQUksT0FBTyxJQUFJLENBQUMsU0FBUyxLQUFLLFdBQVcsRUFBRTtRQUM5QyxFQUFFLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7S0FDakM7SUFFRCxJQUFJLEVBQUUsQ0FBQyxlQUFlLEtBQUssSUFBSSxDQUFDLGVBQWUsRUFBRTtRQUM3QyxFQUFFLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7S0FDN0M7SUFFRCxPQUFPLEVBQUUsQ0FBQztBQUNkLENBQUM7QUFFd0Msa0NBQVcifQ==","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DefaultTestRunnerConfig = void 0;\r\n/**\r\n * Default configuration to be used if the user does not explicitly set configuration.\r\n */\r\nconst DefaultTestRunnerConfig = {\r\n    timeoutMs: 100,\r\n    stopOnFirstFail: false\r\n};\r\nexports.DefaultTestRunnerConfig = DefaultTestRunnerConfig;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGVmYXVsdFRlc3RSdW5uZXJDb25maWcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvQ29uZmlnL0RlZmF1bHRUZXN0UnVubmVyQ29uZmlnLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBOztHQUVHO0FBQ0gsTUFBTSx1QkFBdUIsR0FBcUI7SUFDOUMsU0FBUyxFQUFFLEdBQUc7SUFDZCxlQUFlLEVBQUUsS0FBSztDQUN6QixDQUFDO0FBRU0sMERBQXVCIn0=","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.without = exports.union = exports.SimpleEventEmitter = void 0;\r\n/**\r\n * Simple array union with automatic creation if the arrays don't exist. This is a nice optimization which\r\n * enables the event emitter to lazy-instantiate event callback arrays.\r\n *\r\n * @param arrayA\r\n * @param arrayB\r\n * @return arrayA, modified to include all items from arrayB that weren't already in arrayA. If arrayA doesn't exist,\r\n *         an empty array is returned.\r\n */\r\nfunction union(arrayA, arrayB) {\r\n    if (!arrayA) {\r\n        return arrayB ? arrayB : [];\r\n    }\r\n    if (!arrayB) {\r\n        return arrayA;\r\n    }\r\n    for (const item of arrayB) {\r\n        if (arrayA.indexOf(item) === -1) {\r\n            arrayA.push(item);\r\n        }\r\n    }\r\n    return arrayA;\r\n}\r\nexports.union = union;\r\n/**\r\n * Simple array item removal with automatic creation if the array doesn't exist. This is a nice optimization which\r\n * enables the event emitter to lazy-instantiate event callback arrays.\r\n *\r\n * DOES NOT REMOVE DUPLICATE VALUES!\r\n *\r\n * @param array - The array from which to remove an item.\r\n * @param item - The item to remove from the given array.\r\n * @return The original array, modified to remove the item if it existed. If the array doesn't exist, an empty array\r\n *         is returned.\r\n */\r\nfunction without(array, item) {\r\n    if (!array) {\r\n        return [];\r\n    }\r\n    const indexOfItem = array.indexOf(item);\r\n    if (indexOfItem !== -1) {\r\n        array.splice(indexOfItem, 1);\r\n    }\r\n    return array;\r\n}\r\nexports.without = without;\r\n/**\r\n * A ridiculously simple event emitter with typesafety.\r\n *\r\n * TODO: Maybe opensource this under its own package in the future.\r\n */\r\nclass SimpleEventEmitter {\r\n    constructor() {\r\n        // All event arrays are dynamically filled when calling on/onc.\r\n        this.onListeners = {};\r\n        this.onceListeners = {};\r\n    }\r\n    on(event, callback) {\r\n        (this.onListeners[event]) = union(this.onListeners[event], [callback]);\r\n    }\r\n    once(event, callback) {\r\n        this.onceListeners[event] = union(this.onceListeners[event], [callback]);\r\n    }\r\n    off(event, callback) {\r\n        this.onListeners[event] = without(this.onListeners[event], callback);\r\n        this.onceListeners[event] = without(this.onceListeners[event], callback);\r\n    }\r\n    emit(event, ...args) {\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n    }\r\n    /**\r\n     * Evaluates each function synchronously, but waits for all to asynchronously complete before returning.\r\n     *\r\n     * TODO: Find a better name for this.\r\n     *\r\n     * @param event - The event to emit.\r\n     * @param args - All args to be emitted for the event.\r\n     */\r\n    emitAndWaitForCompletion(event, ...args) {\r\n        const promises = [];\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n        return Promise.all(promises).then((results) => {\r\n            // Intentionally blank, as we want to swallow all actual \"valid\" values.\r\n            return;\r\n        });\r\n    }\r\n}\r\nexports.SimpleEventEmitter = SimpleEventEmitter;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2ltcGxlRXZlbnRFbWl0dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL0V2ZW50RW1pdHRlci9TaW1wbGVFdmVudEVtaXR0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBR0E7Ozs7Ozs7O0dBUUc7QUFDSCxTQUFTLEtBQUssQ0FBSSxNQUFXLEVBQUUsTUFBVztJQUN0QyxJQUFJLENBQUMsTUFBTSxFQUFFO1FBQ1QsT0FBTyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0tBQy9CO0lBRUQsSUFBSSxDQUFDLE1BQU0sRUFBRTtRQUNULE9BQU8sTUFBTSxDQUFDO0tBQ2pCO0lBRUQsS0FBSyxNQUFNLElBQUksSUFBSSxNQUFNLEVBQUU7UUFDdkIsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO1lBQzdCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDckI7S0FDSjtJQUVELE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUM7QUF5R3FELHNCQUFLO0FBdkczRDs7Ozs7Ozs7OztHQVVHO0FBQ0gsU0FBUyxPQUFPLENBQUksS0FBVSxFQUFFLElBQU87SUFDbkMsSUFBSSxDQUFDLEtBQUssRUFBRTtRQUNSLE9BQU8sRUFBRSxDQUFDO0tBQ2I7SUFFRCxNQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hDLElBQUksV0FBVyxLQUFLLENBQUMsQ0FBQyxFQUFFO1FBQ3BCLEtBQUssQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO0tBQ2hDO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQztBQWlGNEQsMEJBQU87QUEvRXBFOzs7O0dBSUc7QUFDSCxNQUFNLGtCQUFrQjtJQUF4QjtRQUVJLCtEQUErRDtRQUM5QyxnQkFBVyxHQUFxRSxF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","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.QueueStack = void 0;\r\n/**\r\n * A very creatively named Queue of Stacks, with some simple helper methods for operating on them.\r\n */\r\nclass QueueStack {\r\n    constructor() {\r\n        this.queue = [];\r\n    }\r\n    /**\r\n     * Pushes the given element onto the end of the top stack.\r\n     *\r\n     * @param element\r\n     */\r\n    pushOnTopStack(element) {\r\n        if (this.queue.length === 0) {\r\n            this.queue.push([element]);\r\n        }\r\n        else {\r\n            this.queue[0].push(element);\r\n        }\r\n    }\r\n    /**\r\n     * Pushes the given element onto the end of the bottom stack.\r\n     *\r\n     * @param element\r\n     */\r\n    pushOnBottomStack(element) {\r\n        if (this.queue.length === 0) {\r\n            this.queue.push([element]);\r\n        }\r\n        else {\r\n            this.queue[this.queue.length - 1].push(element);\r\n        }\r\n    }\r\n    /**\r\n     * Pushes a new stack onto the end of the queue.\r\n     *\r\n     * @param stack\r\n     */\r\n    pushStack(stack) {\r\n        this.queue.push(stack);\r\n    }\r\n    /**\r\n     * Pushes a new stack onto the start of the queue.\r\n     *\r\n     * @param stack\r\n     */\r\n    unshiftStack(stack) {\r\n        this.queue.unshift(stack);\r\n    }\r\n    /**\r\n     * Removes the last stack from the queue and returns it.\r\n     */\r\n    popStack() {\r\n        return this.queue.pop();\r\n    }\r\n    /**\r\n     * Removes the first stack from the queue and returns it.\r\n     */\r\n    shiftStack() {\r\n        return this.queue.shift();\r\n    }\r\n    /**\r\n     * Traverses the queue stack, starting at the top, first element and proceeding down level by level.\r\n     *\r\n     * @param callback\r\n     */\r\n    traverseLevelOrder(callback) {\r\n        let promise = Promise.resolve();\r\n        for (let i = 0; i < this.queue.length; i++) {\r\n            const queue = this.queue[i];\r\n            for (let j = 0; j < queue.length; j++) {\r\n                promise = promise.then(() => callback(queue[j]));\r\n            }\r\n        }\r\n        return promise;\r\n    }\r\n    /**\r\n     * Traverses the queue stack, starting at the bottom, last element and proceeding up level by level.\r\n     *\r\n     * @param callback\r\n     */\r\n    traverseInverseLevelOrder(callback) {\r\n        let promise = Promise.resolve();\r\n        for (let i = this.queue.length - 1; i >= 0; i--) {\r\n            const queue = this.queue[i];\r\n            for (let j = queue.length - 1; j >= 0; j--) {\r\n                promise = promise.then(() => callback(queue[j]));\r\n            }\r\n        }\r\n        return promise;\r\n    }\r\n    /**\r\n     * Resets the stack, removing all previously pushed queues and elements.\r\n     */\r\n    reset() {\r\n        this.queue = [];\r\n    }\r\n}\r\nexports.QueueStack = QueueStack;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUXVldWVTdGFjay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9RdWV1ZVN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBOztHQUVHO0FBQ0gsTUFBTSxVQUFVO0lBQWhCO1FBRVksVUFBSyxHQUFVLEVBQUUsQ0FBQztJQW9HOUIsQ0FBQztJQWxHRzs7OztPQUlHO0lBQ0gsY0FBYyxDQUFDLE9BQVU7UUFDckIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDekIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQzlCO2FBQU07WUFDSCxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUMvQjtJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsaUJBQWlCLENBQUMsT0FBVTtRQUN4QixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUN6QixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FDOUI7YUFBTTtZQUNILElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ25EO0lBQ0wsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxTQUFTLENBQUMsS0FBVTtRQUNoQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILFlBQVksQ0FBQyxLQUFVO1FBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRDs7T0FFRztJQUNILFFBQVE7UUFDSixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsVUFBVTtRQUNOLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILGtCQUFrQixDQUFDLFFBQXVDO1FBQ3RELElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNoQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDeEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDbkMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDcEQ7U0FDSjtRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gseUJBQXlCLENBQUMsUUFBOEI7UUFDcEQsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2hDLEtBQUssSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDN0MsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QixLQUFLLElBQUksQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3hDLE9BQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3BEO1NBQ0o7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLO1FBQ0QsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7SUFDcEIsQ0FBQztDQUNKO0FBRU8sZ0NBQVUifQ==","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TestRunner = void 0;\r\nconst AsyncPromisifier_1 = require(\"./Async/AsyncPromisifier\");\r\nconst TimeoutPromisifier_1 = require(\"./Async/TimeoutPromisifier\");\r\nconst TestRunnerConfig_1 = require(\"./Config/TestRunnerConfig\");\r\nconst DefaultTestRunnerConfig_1 = require(\"./Config/DefaultTestRunnerConfig\");\r\nconst SimpleEventEmitter_1 = require(\"./EventEmitter/SimpleEventEmitter\");\r\nconst QueueStack_1 = require(\"./QueueStack\");\r\nconst QueueStackTypes = [\"before\", \"beforeEach\", \"after\", \"afterEach\"];\r\n/**\r\n * before -> beforeEach -> beforeHook -> it -> afterHook -> afterEach -> after\r\n */\r\nclass TestRunner {\r\n    constructor(config, eventEmitter = new SimpleEventEmitter_1.SimpleEventEmitter()) {\r\n        this.asyncPromisifier = new AsyncPromisifier_1.AsyncPromisifier();\r\n        this.timeoutPromisifier = new TimeoutPromisifier_1.TimeoutPromisifier();\r\n        this.testQueueStack = [];\r\n        this.queueStacks = {\r\n            \"before\": new QueueStack_1.QueueStack(),\r\n            \"beforeEach\": new QueueStack_1.QueueStack(),\r\n            \"after\": new QueueStack_1.QueueStack(),\r\n            \"afterEach\": new QueueStack_1.QueueStack()\r\n        };\r\n        this.currentTest = null;\r\n        this.testRunCancelled = false;\r\n        // This madness is needed to support function/object hybrids, which is remarkably useful but obnoxious in TS.\r\n        this.describe = ((title, execBlock) => {\r\n            this.throwIfTestInProgress(\"describe\");\r\n            this.pushToCurrentTestQueue(\"describe\", title, execBlock);\r\n        });\r\n        this.describeOnly = (title, execBlock) => {\r\n            this.throwIfTestInProgress(\"describe.only\");\r\n            this.pushToCurrentTestQueue(\"describe\", title, execBlock, true);\r\n        };\r\n        this.describeSkip = (title, execBlock, options) => {\r\n            this.throwIfTestInProgress(\"describe.skip\");\r\n            this.pushToCurrentTestQueue(\"describe\", title, execBlock, false, undefined, true);\r\n        };\r\n        this.it = ((title, execBlock, options) => {\r\n            this.throwIfTestInProgress(\"it\");\r\n            this.pushToCurrentTestQueue(\"it\", title, execBlock, false, options ? options.timeoutMs : undefined);\r\n        });\r\n        this.itOnly = (title, execBlock, options) => {\r\n            this.throwIfTestInProgress(\"it.only\");\r\n            this.pushToCurrentTestQueue(\"it\", title, execBlock, true, options ? options.timeoutMs : undefined);\r\n        };\r\n        this.itSkip = (title, execBlock, options) => {\r\n            this.throwIfTestInProgress(\"it.skip\");\r\n            this.pushToCurrentTestQueue(\"it\", title, execBlock, false, undefined, true);\r\n        };\r\n        this.runNextTestQueue = () => __awaiter(this, void 0, void 0, function* () {\r\n            if (this.testQueueStack.length === 0) {\r\n                return;\r\n            }\r\n            let evaluatedTest = false;\r\n            const queue = this.testQueueStack.shift();\r\n            if (queue.firstOnlyIndex !== null) {\r\n                evaluatedTest = yield this.executeTest(queue, queue.tests[queue.firstOnlyIndex]);\r\n            }\r\n            else {\r\n                for (let i = 0; i < queue.tests.length; i++) {\r\n                    evaluatedTest = (yield this.executeTest(queue, queue.tests[i])) || evaluatedTest;\r\n                }\r\n            }\r\n            if (evaluatedTest) {\r\n                yield this.evaluateQueueWithTimeout(\"after\");\r\n            }\r\n        });\r\n        this.throwIfTestInProgress = (name) => {\r\n            if (this.currentTest) {\r\n                throw new Error(`Cannot add an ${name} block while executing a test!`);\r\n            }\r\n        };\r\n        this.resetRunResults = () => {\r\n            this.runResults = {\r\n                elapsedTimeMs: 0,\r\n                totalTests: 0,\r\n                totalSuccesses: 0,\r\n                totalFailures: 0,\r\n                totalTimeouts: 0,\r\n                testResults: []\r\n            };\r\n        };\r\n        this.config = TestRunnerConfig_1.mergeConfig(DefaultTestRunnerConfig_1.DefaultTestRunnerConfig, config);\r\n        this.eventEmitter = eventEmitter;\r\n        this.it.only = this.itOnly;\r\n        this.describe.only = this.describeOnly;\r\n        this.it.skip = this.itSkip;\r\n        this.describe.skip = this.describeSkip;\r\n        this.resetRunResults();\r\n    }\r\n    /**\r\n     * Sets the current file name for all subsequent calls to describe/it/etc. This is used for logging where tests\r\n     * are sourced from.\r\n     */\r\n    setCurrentFile(absolutePath) {\r\n        this.lastFilePathSet = absolutePath;\r\n    }\r\n    on(event, callback) {\r\n        this.eventEmitter.on(event, callback);\r\n    }\r\n    once(event, callback) {\r\n        this.eventEmitter.once(event, callback);\r\n    }\r\n    off(event, callback) {\r\n        this.eventEmitter.off(event, callback);\r\n    }\r\n    before(execBlock) {\r\n        this.throwIfTestInProgress(\"before\");\r\n        this.queueStacks[\"before\"].pushOnBottomStack(execBlock);\r\n    }\r\n    beforeEach(execBlock) {\r\n        this.throwIfTestInProgress(\"beforeEach\");\r\n        this.queueStacks[\"beforeEach\"].pushOnBottomStack(execBlock);\r\n    }\r\n    after(execBlock) {\r\n        this.throwIfTestInProgress(\"after\");\r\n        this.queueStacks[\"after\"].pushOnTopStack(execBlock);\r\n    }\r\n    afterEach(execBlock) {\r\n        this.throwIfTestInProgress(\"afterEach\");\r\n        this.queueStacks[\"afterEach\"].pushOnTopStack(execBlock);\r\n    }\r\n    /**\r\n     * Triggers a test run based on the describes and its added previously.\r\n     *\r\n     * If a test is already in progress, an error will be returned.\r\n     */\r\n    run() {\r\n        if (this.currentRun) {\r\n            throw new Error(\"Can't start a test run if one is already in progress!\");\r\n        }\r\n        const startTime = Date.now();\r\n        this.currentRun = this.runNextTestQueue().then(() => {\r\n            const results = this.runResults;\r\n            results.elapsedTimeMs = Date.now() - startTime;\r\n            this.currentRun = null;\r\n            this.resetRunResults();\r\n            return results;\r\n        }).catch((e) => {\r\n            this.currentRun = null;\r\n            throw e;\r\n        });\r\n        return this.currentRun;\r\n    }\r\n    /**\r\n     * If a test is in progress, the current information for the test will be returned.\r\n     *\r\n     * If not, an error will be thrown.\r\n     */\r\n    getCurrentTestInfo() {\r\n        if (!this.currentTest) {\r\n            throw new Error(\"Can't obtain TestInfo if not actively in a test!\");\r\n        }\r\n        return this.currentTest;\r\n    }\r\n    /**\r\n     * Resets all pending state, including all attached before, beforeEach, after, afterEach, tests, describes, etc.\r\n     *\r\n     * If a test run is already in progress, an error will be thrown.\r\n     */\r\n    reset() {\r\n        if (this.currentRun) {\r\n            throw new Error(\"Can't reset if a test run is already in progress!\");\r\n        }\r\n        this.resetRunResults();\r\n        this.testRunCancelled = false;\r\n        this.testQueueStack = [];\r\n        for (const type of QueueStackTypes) {\r\n            this.queueStacks[type].reset();\r\n        }\r\n    }\r\n    cancel() {\r\n        if (!this.currentRun) {\r\n            return Promise.reject(new Error(\"Not currently executing a test run! Unable to cancel accordingly.\"));\r\n        }\r\n        this.testRunCancelled = true;\r\n        return this.currentRun.then((results) => {\r\n            this.reset();\r\n            return results;\r\n        });\r\n    }\r\n    pushToCurrentTestQueue(type, title, execBlock, only, timeoutMs, skip) {\r\n        if (this.testQueueStack.length === 0) {\r\n            const testQueue = {\r\n                describeTitleChain: [],\r\n                tests: [],\r\n                evaluatedBefores: false,\r\n                skipAllTests: type === \"describe\" && skip,\r\n                firstOnlyIndex: only ? 0 : null\r\n            };\r\n            this.testQueueStack.push(testQueue);\r\n        }\r\n        const currentEntry = this.testQueueStack[this.testQueueStack.length - 1];\r\n        const testEntry = {\r\n            type: type,\r\n            callback: execBlock,\r\n            describeTitleChain: currentEntry.describeTitleChain,\r\n            title: title,\r\n            absoluteFilePath: this.lastFilePathSet,\r\n            skip: skip || currentEntry.skipAllTests\r\n        };\r\n        if (only && currentEntry.firstOnlyIndex === null) {\r\n            currentEntry.firstOnlyIndex = currentEntry.tests.length;\r\n        }\r\n        if (timeoutMs > 0) {\r\n            testEntry.timeoutMs = timeoutMs;\r\n        }\r\n        currentEntry.tests.push(testEntry);\r\n    }\r\n    executeTest(queue, entry) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (entry.absoluteFilePath !== this.currentlyExecutingFilePath) {\r\n                this.currentlyExecutingFilePath = entry.absoluteFilePath;\r\n            }\r\n            if (this.testRunCancelled) {\r\n                return false;\r\n            }\r\n            else if (entry.type === \"describe\") {\r\n                return this.evaluateDescribe(queue, entry);\r\n            }\r\n            else {\r\n                return this.evaluateTest(queue, entry);\r\n            }\r\n        });\r\n    }\r\n    evaluateDescribe(queue, entry) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.testQueueStack.push({\r\n                describeTitleChain: [].concat(queue.describeTitleChain, entry.title),\r\n                tests: [],\r\n                evaluatedBefores: false,\r\n                skipAllTests: entry.skip,\r\n                firstOnlyIndex: null\r\n            });\r\n            for (const type of QueueStackTypes) {\r\n                if (type === \"before\" || type === \"beforeEach\") {\r\n                    this.queueStacks[type].pushStack([]);\r\n                }\r\n                else {\r\n                    this.queueStacks[type].unshiftStack([]);\r\n                }\r\n            }\r\n            yield this.asyncPromisifier.exec(entry.callback, \"describe\");\r\n            yield this.runNextTestQueue();\r\n            for (const type of QueueStackTypes) {\r\n                if (type === \"before\" || type === \"beforeEach\") {\r\n                    this.queueStacks[type].popStack();\r\n                }\r\n                else {\r\n                    this.queueStacks[type].shiftStack();\r\n                }\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n    evaluateTest(queue, entry) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (entry.skip) {\r\n                const testResults = {\r\n                    result: \"skipped\",\r\n                    testInfo: entry,\r\n                    elapsedMs: 0\r\n                };\r\n                this.eventEmitter.emit(\"onTestEnd\", testResults);\r\n                return false;\r\n            }\r\n            if (!queue.evaluatedBefores) {\r\n                queue.evaluatedBefores = true;\r\n                yield this.evaluateQueueWithTimeout(\"before\");\r\n            }\r\n            yield this.evaluateQueueWithTimeout(\"beforeEach\");\r\n            this.currentTest = entry;\r\n            try {\r\n                yield this.executeTestCallback(entry);\r\n                yield this.evaluateQueueWithTimeout(\"afterEach\");\r\n            }\r\n            finally {\r\n                this.runResults.totalTests++;\r\n                this.currentTest = null;\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n    executeTestCallback(entry) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const startTime = Date.now();\r\n            const timeoutValue = entry.timeoutMs >= 0 ? entry.timeoutMs : this.getTimeoutValue(\"it\");\r\n            const testResults = {\r\n                testInfo: entry\r\n            };\r\n            try {\r\n                yield this.timeoutPromisifier.wrap(this.asyncPromisifier.exec(entry.callback, \"Test: \" + entry.title), timeoutValue);\r\n                testResults.result = \"success\";\r\n            }\r\n            catch (error) {\r\n                if (error instanceof TimeoutPromisifier_1.TimeoutError) {\r\n                    testResults.result = \"timeout\";\r\n                }\r\n                else {\r\n                    testResults.result = \"fail\";\r\n                    testResults.error = error;\r\n                }\r\n            }\r\n            testResults.elapsedMs = Date.now() - startTime;\r\n            try {\r\n                // TODO: explicitly add support for returning a new testResult, rather than modifying it inline or throwing.\r\n                yield this.eventEmitter.emitAndWaitForCompletion(\"onBeforeTestEnd\", testResults);\r\n            }\r\n            catch (error) {\r\n                testResults.result = \"fail\";\r\n                testResults.error = error;\r\n            }\r\n            if (testResults.result === \"success\") {\r\n                this.runResults.totalSuccesses++;\r\n            }\r\n            else if (testResults.result === \"timeout\") {\r\n                this.runResults.totalTimeouts++;\r\n            }\r\n            else {\r\n                this.runResults.totalFailures++;\r\n                // If we want to stop additional execution on the first fail, just cancel the rest of the run.\r\n                if (this.config.stopOnFirstFail) {\r\n                    this.testRunCancelled = true;\r\n                }\r\n            }\r\n            this.runResults.testResults.push(testResults);\r\n            this.eventEmitter.emit(\"onTestEnd\", testResults);\r\n        });\r\n    }\r\n    evaluateQueueWithTimeout(type) {\r\n        return this.timeoutPromisifier.wrap(this.evaluateQueue(type), this.getTimeoutValue(type));\r\n    }\r\n    evaluateQueue(type) {\r\n        return this.queueStacks[type].traverseLevelOrder((callback) => this.asyncPromisifier.exec(callback, type));\r\n    }\r\n    getTimeoutValue(type) {\r\n        const timeout = this.config.timeoutMs;\r\n        return typeof timeout === \"number\" ? timeout : timeout[type];\r\n    }\r\n}\r\nexports.TestRunner = TestRunner;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJ1bm5lci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9UZXN0UnVubmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUdBLCtEQUEwRDtBQUMxRCxtRUFBNEU7QUFDNUUsZ0VBQXVGO0FBQ3ZGLDhFQUF5RTtBQUV6RSwwRUFBb0Y7QUFDcEYsNkNBQXdDO0FBZ0J4QyxNQUFNLGVBQWUsR0FBRyxDQUFDLFFBQVEsRUFBRSxZQUFZLEVBQUUsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBa0J2RTs7R0FFRztBQUNILE1BQU0sVUFBVTtJQXlCWixZQUFZLE1BQXlCLEVBQUUsZUFBZSxJQUFJLHVDQUFrQixFQUFZO1FBdkJ2RSxxQkFBZ0IsR0FBRyxJQUFJLG1DQUFnQixFQUFFLENBQUM7UUFDMUMsdUJBQWtCLEdBQUcsSUFBSSx1Q0FBa0IsRUFBRSxDQUFDO1FBS3ZELG1CQUFjLEdBQWdCLEVBQUUsQ0FBQztRQUNqQyxnQkFBVyxHQUFrRTtZQUNqRixRQUFRLEVBQUUsSUFBSSx1QkFBVSxFQUFFO1lBQzFCLFlBQVksRUFBRSxJQUFJLHVCQUFVLEVBQUU7WUFDOUIsT0FBTyxFQUFFLElBQUksdUJBQVUsRUFBRTtZQUN6QixXQUFXLEVBQUUsSUFBSSx1QkFBVSxFQUFFO1NBQ2hDLENBQUM7UUFFTSxnQkFBVyxHQUFxQixJQUFJLENBQUM7UUFDckMscUJBQWdCLEdBQVksS0FBSyxDQUFDO1FBeUMxQyw2R0FBNkc7UUFDcEcsYUFBUSxHQUEyQixDQUFDLENBQUMsS0FBYSxFQUFFLFNBQXFCLEVBQUUsRUFBRTtZQUNsRixJQUFJLENBQUMscUJBQXFCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdkMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsRUFBRSxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUEyQixDQUFDO1FBRXJCLGlCQUFZLEdBQUcsQ0FBQyxLQUFhLEVBQUUsU0FBZ0YsRUFB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","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TestRunner = void 0;\r\nconst TestRunner_1 = require(\"./TestRunner\");\r\nObject.defineProperty(exports, \"TestRunner\", { enumerable: true, get: function () { return TestRunner_1.TestRunner; } });\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkNBQXdDO0FBT1YsMkZBUHRCLHVCQUFVLE9BT3NCIn0=","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.deepEqual = void 0;\r\nfunction deepEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    else if (a instanceof Date && b instanceof Date) {\r\n        return a.getTime() === b.getTime();\r\n    }\r\n    else if (!exists(a) || !exists(b) || typeof a !== \"object\" && typeof b !== \"object\") {\r\n        return a === b;\r\n    }\r\n    else {\r\n        return deepEqualObject(a, b);\r\n    }\r\n}\r\nexports.deepEqual = deepEqual;\r\nfunction deepEqualObject(a, b) {\r\n    let i;\r\n    let key;\r\n    if (!exists(a) || !exists(b)) {\r\n        return false;\r\n    }\r\n    if (a.prototype !== b.prototype) {\r\n        return false;\r\n    }\r\n    let aKeys;\r\n    let bKeys;\r\n    try {\r\n        aKeys = Object.keys(a);\r\n        bKeys = Object.keys(b);\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n    if (aKeys.length !== bKeys.length) {\r\n        return false;\r\n    }\r\n    aKeys.sort();\r\n    bKeys.sort();\r\n    for (i = aKeys.length - 1; i >= 0; i--) {\r\n        if (aKeys[i] !== bKeys[i]) {\r\n            return false;\r\n        }\r\n    }\r\n    for (i = aKeys.length - 1; i >= 0; i--) {\r\n        key = aKeys[i];\r\n        if (!deepEqual(a[key], b[key])) {\r\n            return false;\r\n        }\r\n    }\r\n    return typeof a === typeof b;\r\n}\r\nfunction exists(value) {\r\n    return value !== null && value !== undefined;\r\n}\r\n//# sourceMappingURL=DeepEqual.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.without = exports.union = void 0;\r\nfunction union(arrayA, arrayB) {\r\n    if (!arrayA) {\r\n        return arrayB ? arrayB : [];\r\n    }\r\n    if (!arrayB) {\r\n        return arrayA;\r\n    }\r\n    for (const item of arrayB) {\r\n        if (arrayA.indexOf(item) === -1) {\r\n            arrayA.push(item);\r\n        }\r\n    }\r\n    return arrayA;\r\n}\r\nexports.union = union;\r\nfunction without(array, item) {\r\n    if (!array) {\r\n        return [];\r\n    }\r\n    const indexOfItem = array.indexOf(item);\r\n    if (indexOfItem !== -1) {\r\n        array.splice(indexOfItem, 1);\r\n    }\r\n    return array;\r\n}\r\nexports.without = without;\r\n//# sourceMappingURL=ArrayUtils.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SimpleEventEmitter = void 0;\r\nconst ArrayUtils_1 = require(\"./ArrayUtils\");\r\nclass SimpleEventEmitter {\r\n    constructor() {\r\n        this.onListeners = {};\r\n        this.onceListeners = {};\r\n    }\r\n    on(event, callback) {\r\n        (this.onListeners[event]) = ArrayUtils_1.union(this.onListeners[event], [callback]);\r\n    }\r\n    once(event, callback) {\r\n        this.onceListeners[event] = ArrayUtils_1.union(this.onceListeners[event], [callback]);\r\n    }\r\n    off(event, callback) {\r\n        this.onListeners[event] = ArrayUtils_1.without(this.onListeners[event], callback);\r\n        this.onceListeners[event] = ArrayUtils_1.without(this.onceListeners[event], callback);\r\n    }\r\n    emit(event, ...args) {\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n    }\r\n    emitAndWaitForCompletion(event, ...args) {\r\n        const promises = [];\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n        return Promise.all(promises).then((results) => {\r\n            return;\r\n        });\r\n    }\r\n}\r\nexports.SimpleEventEmitter = SimpleEventEmitter;\r\n//# sourceMappingURL=SimpleEventEmitter.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SortedArray = void 0;\r\nclass SortedArray {\r\n    constructor(compare = compareDefault, initialValues = []) {\r\n        this.array = [];\r\n        this.compareFunction = compare || compareDefault;\r\n        const length = initialValues.length;\r\n        for (let i = 0; i < length; i++) {\r\n            this.insert(initialValues[i]);\r\n        }\r\n    }\r\n    getData() {\r\n        return this.array;\r\n    }\r\n    insert(element) {\r\n        let foundIndex = this.searchInternal(element) + 1;\r\n        const highestIndex = this.array.length - 1;\r\n        while ((foundIndex < highestIndex) && (this.compareFunction(element, this.array[foundIndex]) === 0)) {\r\n            foundIndex++;\r\n        }\r\n        let index = this.array.length;\r\n        this.array.push(element);\r\n        while (index > foundIndex) {\r\n            this.array[index] = this.array[--index];\r\n        }\r\n        this.array[foundIndex] = element;\r\n    }\r\n    search(element) {\r\n        const foundIndex = this.searchInternal(element);\r\n        if (this.compareFunction(this.array[foundIndex], element) !== 0) {\r\n            return -1;\r\n        }\r\n        return foundIndex;\r\n    }\r\n    remove(element) {\r\n        const index = this.search(element);\r\n        if (index >= 0) {\r\n            this.array.splice(index, 1);\r\n        }\r\n    }\r\n    searchInternal(element) {\r\n        let high = this.array.length - 1;\r\n        let low = 0;\r\n        let index;\r\n        let ordering;\r\n        while (high >= low) {\r\n            index = Math.floor((high + low) / 2);\r\n            ordering = this.compareFunction(this.array[index], element);\r\n            if (ordering < 0) {\r\n                low = index + 1;\r\n            }\r\n            else if (ordering > 0) {\r\n                high = index - 1;\r\n            }\r\n            else {\r\n                return index;\r\n            }\r\n        }\r\n        return high;\r\n    }\r\n}\r\nexports.SortedArray = SortedArray;\r\nfunction compareDefault(a, b) {\r\n    if (a < b) {\r\n        return -1;\r\n    }\r\n    else if (a > b) {\r\n        return 1;\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\n//# sourceMappingURL=SortedArray.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.INTERNAL_MOCKER_NAME = exports.printObject = void 0;\r\nconst INTERNAL_MOCKER_NAME = \"__internalMocker\";\r\nexports.INTERNAL_MOCKER_NAME = INTERNAL_MOCKER_NAME;\r\nfunction GetMockerDataSafe(mock) {\r\n    const internalMocker = mock[INTERNAL_MOCKER_NAME];\r\n    return internalMocker !== null && internalMocker !== void 0 ? internalMocker : null;\r\n}\r\nfunction printObject(object) {\r\n    if (object === null) {\r\n        return \"null\";\r\n    }\r\n    if (object === undefined) {\r\n        return \"undefined\";\r\n    }\r\n    if (object instanceof RegExp) {\r\n        return object.toString();\r\n    }\r\n    const mockerData = GetMockerDataSafe(object);\r\n    if (mockerData !== null) {\r\n        return mockerData.mockName;\r\n    }\r\n    return JSON.stringify(object);\r\n}\r\nexports.printObject = printObject;\r\n//# sourceMappingURL=Stringify.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.matcher = exports.regexMatches = exports.startsWith = exports.lte = exports.lt = exports.gte = exports.gt = exports.eq = exports.any = void 0;\r\nconst DeepEqual_1 = require(\"./DeepEqual\");\r\nconst Stringify_1 = require(\"./Stringify\");\r\nfunction any() {\r\n    const validator = {\r\n        precedence: -1,\r\n        matches: () => true,\r\n        description: () => \"any()\",\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.any = any;\r\nfunction gt(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue > value),\r\n        description: () => `gt(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.gt = gt;\r\nfunction lt(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue < value),\r\n        description: () => `lt(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.lt = lt;\r\nfunction gte(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue >= value),\r\n        description: () => `gte(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.gte = gte;\r\nfunction lte(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue <= value),\r\n        description: () => `lte(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.lte = lte;\r\nfunction eq(value) {\r\n    const validator = {\r\n        precedence: 1,\r\n        matches: ((realValue) => DeepEqual_1.deepEqual(value, realValue)),\r\n        description: () => Stringify_1.printObject(value),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.eq = eq;\r\nfunction startsWith(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue.startsWith(value)),\r\n        description: () => \"startsWith \" + value,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.startsWith = startsWith;\r\nfunction regexMatches(value) {\r\n    const validator = {\r\n        matches: ((realValue) => value.test(realValue)),\r\n        description: () => value.toString(),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.regexMatches = regexMatches;\r\nfunction matcher(func) {\r\n    const validator = {\r\n        matches: (realValue) => func(realValue),\r\n        description: () => func.toString(),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.matcher = matcher;\r\n//# sourceMappingURL=ArgumentValidator.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.printObject = exports.INTERNAL_MOCKER_NAME = exports.startsWith = exports.regexMatches = exports.matcher = exports.lte = exports.lt = exports.gte = exports.gt = exports.eq = exports.any = exports.SimpleEventEmitter = exports.SortedArray = exports.deepEqual = void 0;\r\nconst DeepEqual_1 = require(\"./DeepEqual\");\r\nObject.defineProperty(exports, \"deepEqual\", { enumerable: true, get: function () { return DeepEqual_1.deepEqual; } });\r\nconst SimpleEventEmitter_1 = require(\"./SimpleEventEmitter\");\r\nObject.defineProperty(exports, \"SimpleEventEmitter\", { enumerable: true, get: function () { return SimpleEventEmitter_1.SimpleEventEmitter; } });\r\nconst SortedArray_1 = require(\"./SortedArray\");\r\nObject.defineProperty(exports, \"SortedArray\", { enumerable: true, get: function () { return SortedArray_1.SortedArray; } });\r\nconst ArgumentValidator_1 = require(\"./ArgumentValidator\");\r\nObject.defineProperty(exports, \"any\", { enumerable: true, get: function () { return ArgumentValidator_1.any; } });\r\nObject.defineProperty(exports, \"eq\", { enumerable: true, get: function () { return ArgumentValidator_1.eq; } });\r\nObject.defineProperty(exports, \"gt\", { enumerable: true, get: function () { return ArgumentValidator_1.gt; } });\r\nObject.defineProperty(exports, \"gte\", { enumerable: true, get: function () { return ArgumentValidator_1.gte; } });\r\nObject.defineProperty(exports, \"lt\", { enumerable: true, get: function () { return ArgumentValidator_1.lt; } });\r\nObject.defineProperty(exports, \"lte\", { enumerable: true, get: function () { return ArgumentValidator_1.lte; } });\r\nObject.defineProperty(exports, \"matcher\", { enumerable: true, get: function () { return ArgumentValidator_1.matcher; } });\r\nObject.defineProperty(exports, \"regexMatches\", { enumerable: true, get: function () { return ArgumentValidator_1.regexMatches; } });\r\nObject.defineProperty(exports, \"startsWith\", { enumerable: true, get: function () { return ArgumentValidator_1.startsWith; } });\r\nconst Stringify_1 = require(\"./Stringify\");\r\nObject.defineProperty(exports, \"INTERNAL_MOCKER_NAME\", { enumerable: true, get: function () { return Stringify_1.INTERNAL_MOCKER_NAME; } });\r\nObject.defineProperty(exports, \"printObject\", { enumerable: true, get: function () { return Stringify_1.printObject; } });\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.assert = void 0;\r\nconst umbra_util_1 = require(\"@umbra-test/umbra-util\");\r\nclass AssertionError extends Error {\r\n    constructor(ourMessage, theirMessage) {\r\n        const message = theirMessage ? ourMessage + \"\\n\" + theirMessage : ourMessage;\r\n        super(message);\r\n    }\r\n}\r\nclass assert {\r\n    static that(output) {\r\n    }\r\n    static equal(expected, actual, message) {\r\n        if (umbra_util_1.deepEqual(expected, actual)) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} to deeply equal ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static notEqual(expected, actual, message) {\r\n        if (!umbra_util_1.deepEqual(expected, actual)) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} to not deeply equal ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static looseEqual(actual, expected, message) {\r\n        if (expected == actual) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} == ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static notLooseEqual(actual, expected, message) {\r\n        if (expected != actual) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} != ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static strictEqual(actual, expected, message) {\r\n        if (Object.is(expected, actual)) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} to strictly equal ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static notStrictEqual(actual, expected, message) {\r\n        if (!Object.is(expected, actual)) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} to not strictly equal ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static is(actual, expected, message) {\r\n        assert.strictEqual(actual, expected, message);\r\n    }\r\n    static has(target, keyPath, expected, message) {\r\n        assert.exists(target, \"target\");\r\n        assert.exists(keyPath, \"keyPath\");\r\n        assert.exists(target, \"target\");\r\n        const pathArray = keyPath.split(\".\");\r\n        let result = target;\r\n        for (const path of pathArray) {\r\n            const newResult = result[path];\r\n            if (!newResult) {\r\n                assert.fail(`Missing key \"${path}\" in object ${umbra_util_1.printObject(result)}\\nAvailable keys: ${umbra_util_1.printObject(Object.keys(expected))}`);\r\n            }\r\n            result = newResult;\r\n        }\r\n        assert.strictEqual(result, expected, message);\r\n    }\r\n    static regexMatches(actual, expected, message) {\r\n        if (expected.test(actual)) {\r\n            return;\r\n        }\r\n        throw new AssertionError(`Expected ${umbra_util_1.printObject(actual)} to match the regex ${umbra_util_1.printObject(expected)}`, message);\r\n    }\r\n    static resolvesTo(actual, expected, message) {\r\n        return actual\r\n            .then((actualValue) => {\r\n            assert.equal(actualValue, expected);\r\n        }, (e) => {\r\n            throw new AssertionError(`Promise should not have successfully resolved.\\nException: ${e}\\n`, message);\r\n        });\r\n    }\r\n    static rejects(actual, expected, message) {\r\n        const errorMessage = expected instanceof Error ? expected.message : expected;\r\n        return actual\r\n            .then(() => {\r\n            throw new AssertionError(\"Promise should not have successfully resolved\", message);\r\n        }, (e) => {\r\n            if (errorMessage) {\r\n                assert.equal(errorMessage, e.message);\r\n            }\r\n        });\r\n    }\r\n    static fail(message) {\r\n        throw new AssertionError(\"Test failed\", message);\r\n    }\r\n    static isTrue(value, message) {\r\n        assert.equal(true, value, message);\r\n    }\r\n    static isFalse(value, message) {\r\n        assert.equal(false, value, message);\r\n    }\r\n    static isTruthy(value, message) {\r\n        if (!value) {\r\n            throw new AssertionError(`Expected ${value} to be truthy`, message);\r\n        }\r\n    }\r\n    static isFalsy(value, message) {\r\n        if (value) {\r\n            throw new AssertionError(`Expected ${value} to be falsy`, message);\r\n        }\r\n    }\r\n    static exists(expected, message) {\r\n        this.notEqual(expected, null, `Expected ${umbra_util_1.printObject(expected)} to not be null. ${message}`);\r\n        this.notEqual(expected, undefined, `Expected ${umbra_util_1.printObject(expected)} to not be undefined. ${message}`);\r\n        return true;\r\n    }\r\n    static contains(target, value, message) {\r\n        this.exists(target);\r\n        if (typeof target === \"string\") {\r\n            assert.isTrue(target.indexOf(value) !== -1, `String: ${value} was not found in ${target}`);\r\n        }\r\n        else if (Array.isArray(target)) {\r\n            assert.isTrue(target.indexOf(value) !== -1, `${umbra_util_1.printObject(value)} was not found in target array ${umbra_util_1.printObject(target)}. ${message !== null && message !== void 0 ? message : \"\"}`);\r\n        }\r\n        else {\r\n            for (const [entryKey, entryValue] of Object.entries(value)) {\r\n                assert.equal(target[entryKey], entryValue);\r\n            }\r\n        }\r\n    }\r\n    static containsAll(target, values, message) {\r\n        this.exists(target);\r\n        this.exists(values);\r\n        for (const value of values) {\r\n            assert.contains(target, value, message);\r\n        }\r\n    }\r\n    static matchesSnapshotFile(snapshot) {\r\n    }\r\n    static matchesSnapshotString(snapshot, snapshotString) {\r\n    }\r\n}\r\nexports.assert = assert;\r\n//# sourceMappingURL=Assert.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.expect = exports.Expect = void 0;\r\nconst Assert_1 = require(\"./Assert\");\r\nclass Expect {\r\n    constructor(target) {\r\n        this.target = target;\r\n    }\r\n    toBe(value) {\r\n        Assert_1.assert.equal(this.target, value);\r\n    }\r\n    toHaveProperty(keyPath, value) {\r\n        Assert_1.assert.has(this.target, keyPath, value);\r\n    }\r\n    toBeTruthy() {\r\n        Assert_1.assert.isTruthy(this.target);\r\n    }\r\n    toBeFalsy() {\r\n        Assert_1.assert.isFalsy(this.target);\r\n    }\r\n}\r\nexports.Expect = Expect;\r\nfunction expect(target) {\r\n    return new Expect(target);\r\n}\r\nexports.expect = expect;\r\n//# sourceMappingURL=Expect.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Expect = exports.expect = exports.assert = void 0;\r\nconst Assert_1 = require(\"./Assert\");\r\nObject.defineProperty(exports, \"assert\", { enumerable: true, get: function () { return Assert_1.assert; } });\r\nconst Expect_1 = require(\"./Expect\");\r\nObject.defineProperty(exports, \"Expect\", { enumerable: true, get: function () { return Expect_1.Expect; } });\r\nObject.defineProperty(exports, \"expect\", { enumerable: true, get: function () { return Expect_1.expect; } });\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.deepEqual = void 0;\r\nfunction deepEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    else if (a instanceof Date && b instanceof Date) {\r\n        return a.getTime() === b.getTime();\r\n    }\r\n    else if (!exists(a) || !exists(b) || typeof a !== \"object\" && typeof b !== \"object\") {\r\n        return a === b;\r\n    }\r\n    else {\r\n        return deepEqualObject(a, b);\r\n    }\r\n}\r\nexports.deepEqual = deepEqual;\r\nfunction deepEqualObject(a, b) {\r\n    let i;\r\n    let key;\r\n    if (!exists(a) || !exists(b)) {\r\n        return false;\r\n    }\r\n    if (a.prototype !== b.prototype) {\r\n        return false;\r\n    }\r\n    let aKeys;\r\n    let bKeys;\r\n    try {\r\n        aKeys = Object.keys(a);\r\n        bKeys = Object.keys(b);\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n    if (aKeys.length !== bKeys.length) {\r\n        return false;\r\n    }\r\n    aKeys.sort();\r\n    bKeys.sort();\r\n    for (i = aKeys.length - 1; i >= 0; i--) {\r\n        if (aKeys[i] !== bKeys[i]) {\r\n            return false;\r\n        }\r\n    }\r\n    for (i = aKeys.length - 1; i >= 0; i--) {\r\n        key = aKeys[i];\r\n        if (!deepEqual(a[key], b[key])) {\r\n            return false;\r\n        }\r\n    }\r\n    return typeof a === typeof b;\r\n}\r\nfunction exists(value) {\r\n    return value !== null && value !== undefined;\r\n}\r\n//# sourceMappingURL=DeepEqual.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.without = exports.union = void 0;\r\nfunction union(arrayA, arrayB) {\r\n    if (!arrayA) {\r\n        return arrayB ? arrayB : [];\r\n    }\r\n    if (!arrayB) {\r\n        return arrayA;\r\n    }\r\n    for (const item of arrayB) {\r\n        if (arrayA.indexOf(item) === -1) {\r\n            arrayA.push(item);\r\n        }\r\n    }\r\n    return arrayA;\r\n}\r\nexports.union = union;\r\nfunction without(array, item) {\r\n    if (!array) {\r\n        return [];\r\n    }\r\n    const indexOfItem = array.indexOf(item);\r\n    if (indexOfItem !== -1) {\r\n        array.splice(indexOfItem, 1);\r\n    }\r\n    return array;\r\n}\r\nexports.without = without;\r\n//# sourceMappingURL=ArrayUtils.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SimpleEventEmitter = void 0;\r\nconst ArrayUtils_1 = require(\"./ArrayUtils\");\r\nclass SimpleEventEmitter {\r\n    constructor() {\r\n        this.onListeners = {};\r\n        this.onceListeners = {};\r\n    }\r\n    on(event, callback) {\r\n        (this.onListeners[event]) = ArrayUtils_1.union(this.onListeners[event], [callback]);\r\n    }\r\n    once(event, callback) {\r\n        this.onceListeners[event] = ArrayUtils_1.union(this.onceListeners[event], [callback]);\r\n    }\r\n    off(event, callback) {\r\n        this.onListeners[event] = ArrayUtils_1.without(this.onListeners[event], callback);\r\n        this.onceListeners[event] = ArrayUtils_1.without(this.onceListeners[event], callback);\r\n    }\r\n    emit(event, ...args) {\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                callback.call(null, ...args);\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n    }\r\n    emitAndWaitForCompletion(event, ...args) {\r\n        const promises = [];\r\n        if (this.onListeners[event]) {\r\n            for (const callback of this.onListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n        }\r\n        if (this.onceListeners[event] && this.onceListeners[event].length > 0) {\r\n            for (const callback of this.onceListeners[event]) {\r\n                try {\r\n                    promises.push(Promise.resolve(callback.call(null, ...args)));\r\n                }\r\n                catch (e) {\r\n                    promises.push(Promise.reject(e));\r\n                }\r\n            }\r\n            this.onceListeners[event] = [];\r\n        }\r\n        return Promise.all(promises).then((results) => {\r\n            return;\r\n        });\r\n    }\r\n}\r\nexports.SimpleEventEmitter = SimpleEventEmitter;\r\n//# sourceMappingURL=SimpleEventEmitter.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SortedArray = void 0;\r\nclass SortedArray {\r\n    constructor(compare = compareDefault, initialValues = []) {\r\n        this.array = [];\r\n        this.compareFunction = compare || compareDefault;\r\n        const length = initialValues.length;\r\n        for (let i = 0; i < length; i++) {\r\n            this.insert(initialValues[i]);\r\n        }\r\n    }\r\n    getData() {\r\n        return this.array;\r\n    }\r\n    insert(element) {\r\n        let foundIndex = this.searchInternal(element) + 1;\r\n        const highestIndex = this.array.length - 1;\r\n        while ((foundIndex < highestIndex) && (this.compareFunction(element, this.array[foundIndex]) === 0)) {\r\n            foundIndex++;\r\n        }\r\n        let index = this.array.length;\r\n        this.array.push(element);\r\n        while (index > foundIndex) {\r\n            this.array[index] = this.array[--index];\r\n        }\r\n        this.array[foundIndex] = element;\r\n    }\r\n    search(element) {\r\n        const foundIndex = this.searchInternal(element);\r\n        if (this.compareFunction(this.array[foundIndex], element) !== 0) {\r\n            return -1;\r\n        }\r\n        return foundIndex;\r\n    }\r\n    remove(element) {\r\n        const index = this.search(element);\r\n        if (index >= 0) {\r\n            this.array.splice(index, 1);\r\n        }\r\n    }\r\n    searchInternal(element) {\r\n        let high = this.array.length - 1;\r\n        let low = 0;\r\n        let index;\r\n        let ordering;\r\n        while (high >= low) {\r\n            index = Math.floor((high + low) / 2);\r\n            ordering = this.compareFunction(this.array[index], element);\r\n            if (ordering < 0) {\r\n                low = index + 1;\r\n            }\r\n            else if (ordering > 0) {\r\n                high = index - 1;\r\n            }\r\n            else {\r\n                return index;\r\n            }\r\n        }\r\n        return high;\r\n    }\r\n}\r\nexports.SortedArray = SortedArray;\r\nfunction compareDefault(a, b) {\r\n    if (a < b) {\r\n        return -1;\r\n    }\r\n    else if (a > b) {\r\n        return 1;\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\n//# sourceMappingURL=SortedArray.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.INTERNAL_MOCKER_NAME = exports.printObject = void 0;\r\nconst INTERNAL_MOCKER_NAME = \"__internalMocker\";\r\nexports.INTERNAL_MOCKER_NAME = INTERNAL_MOCKER_NAME;\r\nfunction GetMockerDataSafe(mock) {\r\n    const internalMocker = mock[INTERNAL_MOCKER_NAME];\r\n    return internalMocker !== null && internalMocker !== void 0 ? internalMocker : null;\r\n}\r\nconst defaultIndent = \"  \";\r\nfunction printString(object) {\r\n    if (typeof object === \"symbol\" || typeof object === \"number\") {\r\n        return String(object);\r\n    }\r\n    return `\"${String(object).replace(/\"/g, \"\\\\\\\"\").replace(/\\\\?'/g, \"\\\\'\").replace(/\\r/g, \"\\\\r\").replace(/\\n/g, \"\\\\n\")}\"`;\r\n}\r\nfunction printObject(object) {\r\n    const alreadySeenObjects = [];\r\n    const printObjectCapture = (objectCaptured, indent = defaultIndent) => {\r\n        if (objectCaptured === null) {\r\n            return \"null\";\r\n        }\r\n        if (objectCaptured === undefined) {\r\n            return \"undefined\";\r\n        }\r\n        if (objectCaptured instanceof RegExp) {\r\n            return objectCaptured.toString();\r\n        }\r\n        if (objectCaptured instanceof Date) {\r\n            return `new Date(\"${objectCaptured.toISOString()}\")`;\r\n        }\r\n        if (objectCaptured instanceof Error) {\r\n            return `new Error(${objectCaptured.message})`;\r\n        }\r\n        if (alreadySeenObjects.indexOf(objectCaptured) !== -1) {\r\n            return `[[Circular Object Reference]]`;\r\n        }\r\n        const mockerData = GetMockerDataSafe(objectCaptured);\r\n        if (mockerData !== null) {\r\n            return mockerData.mockName;\r\n        }\r\n        const typeofObject = typeof objectCaptured;\r\n        if (typeofObject === \"function\" || typeofObject === \"boolean\" || typeofObject === \"number\" || typeofObject === \"symbol\") {\r\n            return String(objectCaptured);\r\n        }\r\n        if (Array.isArray(objectCaptured)) {\r\n            const arrayData = [];\r\n            alreadySeenObjects.push(objectCaptured);\r\n            for (const item of objectCaptured) {\r\n                arrayData.push(`${indent}${printObjectCapture(item, indent + defaultIndent)}`);\r\n            }\r\n            alreadySeenObjects.pop();\r\n            return `[\\n${arrayData.join(\",\\n\")}\\n${indent.substr(defaultIndent.length)}]`;\r\n        }\r\n        if (objectCaptured instanceof Object) {\r\n            alreadySeenObjects.push(objectCaptured);\r\n            const keys = Reflect.ownKeys(objectCaptured);\r\n            const keyStrings = [];\r\n            for (const key of keys) {\r\n                keyStrings.push(`${indent}${printString(key)}: ${printObjectCapture(Reflect.get(objectCaptured, key), indent + defaultIndent)}`);\r\n            }\r\n            alreadySeenObjects.pop();\r\n            return `{\\n${keyStrings.join(\",\\n\")}\\n${indent.substr(defaultIndent.length)}}`;\r\n        }\r\n        return printString(objectCaptured);\r\n    };\r\n    return printObjectCapture(object);\r\n}\r\nexports.printObject = printObject;\r\n//# sourceMappingURL=Stringify.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.matcher = exports.regexMatches = exports.startsWith = exports.lte = exports.lt = exports.gte = exports.gt = exports.eq = exports.any = void 0;\r\nconst DeepEqual_1 = require(\"./DeepEqual\");\r\nconst Stringify_1 = require(\"./Stringify\");\r\nfunction any() {\r\n    const validator = {\r\n        precedence: -1,\r\n        matches: () => true,\r\n        description: () => \"any()\",\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.any = any;\r\nfunction gt(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue > value),\r\n        description: () => `gt(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.gt = gt;\r\nfunction lt(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue < value),\r\n        description: () => `lt(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.lt = lt;\r\nfunction gte(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue >= value),\r\n        description: () => `gte(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.gte = gte;\r\nfunction lte(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue <= value),\r\n        description: () => `lte(${Stringify_1.printObject(value)})`,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.lte = lte;\r\nfunction eq(value) {\r\n    const validator = {\r\n        precedence: 1,\r\n        matches: ((realValue) => DeepEqual_1.deepEqual(value, realValue)),\r\n        description: () => Stringify_1.printObject(value),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.eq = eq;\r\nfunction startsWith(value) {\r\n    const validator = {\r\n        matches: ((realValue) => realValue.startsWith(value)),\r\n        description: () => \"startsWith \" + value,\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.startsWith = startsWith;\r\nfunction regexMatches(value) {\r\n    const validator = {\r\n        matches: ((realValue) => value.test(realValue)),\r\n        description: () => value.toString(),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.regexMatches = regexMatches;\r\nfunction matcher(func) {\r\n    const validator = {\r\n        matches: (realValue) => func(realValue),\r\n        description: () => func.toString(),\r\n        equals: (other) => other.description() === validator.description()\r\n    };\r\n    return validator;\r\n}\r\nexports.matcher = matcher;\r\n//# sourceMappingURL=ArgumentValidator.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.printObject = exports.INTERNAL_MOCKER_NAME = exports.startsWith = exports.regexMatches = exports.matcher = exports.lte = exports.lt = exports.gte = exports.gt = exports.eq = exports.any = exports.SimpleEventEmitter = exports.SortedArray = exports.deepEqual = void 0;\r\nconst DeepEqual_1 = require(\"./DeepEqual\");\r\nObject.defineProperty(exports, \"deepEqual\", { enumerable: true, get: function () { return DeepEqual_1.deepEqual; } });\r\nconst SimpleEventEmitter_1 = require(\"./SimpleEventEmitter\");\r\nObject.defineProperty(exports, \"SimpleEventEmitter\", { enumerable: true, get: function () { return SimpleEventEmitter_1.SimpleEventEmitter; } });\r\nconst SortedArray_1 = require(\"./SortedArray\");\r\nObject.defineProperty(exports, \"SortedArray\", { enumerable: true, get: function () { return SortedArray_1.SortedArray; } });\r\nconst ArgumentValidator_1 = require(\"./ArgumentValidator\");\r\nObject.defineProperty(exports, \"any\", { enumerable: true, get: function () { return ArgumentValidator_1.any; } });\r\nObject.defineProperty(exports, \"eq\", { enumerable: true, get: function () { return ArgumentValidator_1.eq; } });\r\nObject.defineProperty(exports, \"gt\", { enumerable: true, get: function () { return ArgumentValidator_1.gt; } });\r\nObject.defineProperty(exports, \"gte\", { enumerable: true, get: function () { return ArgumentValidator_1.gte; } });\r\nObject.defineProperty(exports, \"lt\", { enumerable: true, get: function () { return ArgumentValidator_1.lt; } });\r\nObject.defineProperty(exports, \"lte\", { enumerable: true, get: function () { return ArgumentValidator_1.lte; } });\r\nObject.defineProperty(exports, \"matcher\", { enumerable: true, get: function () { return ArgumentValidator_1.matcher; } });\r\nObject.defineProperty(exports, \"regexMatches\", { enumerable: true, get: function () { return ArgumentValidator_1.regexMatches; } });\r\nObject.defineProperty(exports, \"startsWith\", { enumerable: true, get: function () { return ArgumentValidator_1.startsWith; } });\r\nconst Stringify_1 = require(\"./Stringify\");\r\nObject.defineProperty(exports, \"INTERNAL_MOCKER_NAME\", { enumerable: true, get: function () { return Stringify_1.INTERNAL_MOCKER_NAME; } });\r\nObject.defineProperty(exports, \"printObject\", { enumerable: true, get: function () { return Stringify_1.printObject; } });\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.newCapture = void 0;\r\nclass CaptureInternal {\r\n    constructor() {\r\n        this.all = [];\r\n    }\r\n    get first() {\r\n        if (this.all.length === 0) {\r\n            return null;\r\n        }\r\n        return this.all[0];\r\n    }\r\n    get last() {\r\n        if (this.all.length === 0) {\r\n            return null;\r\n        }\r\n        return this.all[this.all.length - 1];\r\n    }\r\n    matches(arg) {\r\n        this.all.push(arg);\r\n        return true;\r\n    }\r\n    description() {\r\n        if (this.all.length === 0) {\r\n            return \"Argument captor. No arguments captured\";\r\n        }\r\n        return \"Argument captor. Currently captured args: \" + this.all;\r\n    }\r\n    equals(other) {\r\n        if (other instanceof CaptureInternal) {\r\n            return other.all === this.all;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nfunction newCapture() {\r\n    return new CaptureInternal();\r\n}\r\nexports.newCapture = newCapture;\r\n//# sourceMappingURL=Capture.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.MockType = exports.INTERNAL_MOCKER_NAME = exports.createInvalidMockError = exports.GetInternalMockerSafe = exports.GetInternalMocker = exports.CreateInternalMocker = void 0;\r\nconst umbra_util_1 = require(\"@umbra-test/umbra-util\");\r\nObject.defineProperty(exports, \"INTERNAL_MOCKER_NAME\", { enumerable: true, get: function () { return umbra_util_1.INTERNAL_MOCKER_NAME; } });\r\nvar MockType;\r\n(function (MockType) {\r\n    MockType[MockType[\"Instance\"] = 0] = \"Instance\";\r\n    MockType[MockType[\"Static\"] = 1] = \"Static\";\r\n    MockType[MockType[\"Partial\"] = 2] = \"Partial\";\r\n})(MockType || (MockType = {}));\r\nexports.MockType = MockType;\r\nfunction GetInternalMockerSafe(mock) {\r\n    if (mock === null || mock === undefined) {\r\n        return null;\r\n    }\r\n    const internalMocker = mock[umbra_util_1.INTERNAL_MOCKER_NAME];\r\n    return internalMocker !== null && internalMocker !== void 0 ? internalMocker : null;\r\n}\r\nexports.GetInternalMockerSafe = GetInternalMockerSafe;\r\nfunction GetInternalMocker(mock) {\r\n    const internalMocker = GetInternalMockerSafe(mock);\r\n    if (internalMocker === null) {\r\n        throw createInvalidMockError(mock);\r\n    }\r\n    return internalMocker;\r\n}\r\nexports.GetInternalMocker = GetInternalMocker;\r\nfunction createInvalidMockError(object) {\r\n    return new Error(`Passed an object that was not a mock. Object provided: ${umbra_util_1.printObject(object)}`);\r\n}\r\nexports.createInvalidMockError = createInvalidMockError;\r\nfunction CreateInternalMocker(mockedFunction, realFunction, mockName, options, mockType) {\r\n    const internalMocker = {\r\n        expectations: [],\r\n        recordedInvocations: [],\r\n        realFunction: realFunction,\r\n        options: options,\r\n        inProgressInOrder: [],\r\n        isInExpectation: false,\r\n        mockName: mockName !== null && mockName !== void 0 ? mockName : \"mock\",\r\n        mockType: mockType\r\n    };\r\n    mockedFunction[umbra_util_1.INTERNAL_MOCKER_NAME] = internalMocker;\r\n    return internalMocker;\r\n}\r\nexports.CreateInternalMocker = CreateInternalMocker;\r\n//# sourceMappingURL=InternalMocker.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StacktraceUtils = void 0;\r\nclass StacktraceUtils {\r\n    static getCurrentMockLocation(depth) {\r\n        const stackTrace = new Error().stack;\r\n        if (stackTrace === undefined) {\r\n            return null;\r\n        }\r\n        const stackTraceLines = stackTrace.split(\"\\n\");\r\n        const length = stackTraceLines.length;\r\n        if (length < depth + 2) {\r\n            return null;\r\n        }\r\n        let i = 2;\r\n        let callingLocation = null;\r\n        for (; i < length; i++) {\r\n            callingLocation = stackTraceLines[i];\r\n            if (/(expect|InvocationHandler\\.apply).*umbra/.test(callingLocation)) {\r\n                i++;\r\n                callingLocation = stackTraceLines[i];\r\n                break;\r\n            }\r\n        }\r\n        if (callingLocation === null) {\r\n            return null;\r\n        }\r\n        const matches = /.*?\\((.*?)\\)/.exec(callingLocation);\r\n        if (matches === null) {\r\n            return null;\r\n        }\r\n        return matches[1];\r\n    }\r\n}\r\nexports.StacktraceUtils = StacktraceUtils;\r\n//# sourceMappingURL=StackTraceParser.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.verifyArgumentMatcher = exports.findBestArgumentMatcher = exports.createMockedFunction = void 0;\r\nconst umbra_util_1 = require(\"@umbra-test/umbra-util\");\r\nconst InternalMocker_1 = require(\"./InternalMocker\");\r\nconst Mock_1 = require(\"./Mock\");\r\nconst StackTraceParser_1 = require(\"./StackTraceParser\");\r\nfunction findBestArgumentMatcher(expectations, args) {\r\n    const argumentMatcherArray = new umbra_util_1.SortedArray((a, b) => {\r\n        if (a === undefined && b === undefined) {\r\n            return 0;\r\n        }\r\n        else if (a === undefined) {\r\n            return 1;\r\n        }\r\n        else if (b === undefined) {\r\n            return -1;\r\n        }\r\n        if (a.inOrderOverride !== null && b.inOrderOverride == null) {\r\n            return -1;\r\n        }\r\n        if (a.inOrderOverride === null && b.inOrderOverride !== null) {\r\n            return 1;\r\n        }\r\n        if (a.expectedArgs === null && b.expectedArgs === null) {\r\n            return 0;\r\n        }\r\n        else if (a.expectedArgs === null) {\r\n            return 1;\r\n        }\r\n        else if (b.expectedArgs === null) {\r\n            return -1;\r\n        }\r\n        const argLengthDifference = b.expectedArgs.length - a.expectedArgs.length;\r\n        if (argLengthDifference !== 0) {\r\n            return argLengthDifference;\r\n        }\r\n        const aMatcherPrecedence = sumMatchers(a.expectedArgs);\r\n        const bMatcherPrecedence = sumMatchers(b.expectedArgs);\r\n        return bMatcherPrecedence - aMatcherPrecedence;\r\n    });\r\n    for (const expectation of expectations) {\r\n        argumentMatcherArray.insert(expectation);\r\n    }\r\n    for (const expectation of argumentMatcherArray.getData()) {\r\n        if (expectation.callCount >= expectation.expectedRange.end) {\r\n            continue;\r\n        }\r\n        const expectedArgs = expectation.expectedArgs;\r\n        const isValid = verifyArgumentMatcher(expectedArgs, args);\r\n        if (isValid) {\r\n            return expectation;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexports.findBestArgumentMatcher = findBestArgumentMatcher;\r\nfunction sumMatchers(expectedArgs) {\r\n    let sum = 0;\r\n    for (const arg of expectedArgs) {\r\n        sum += arg.precedence !== undefined ? arg.precedence : 0;\r\n    }\r\n    return sum;\r\n}\r\nfunction verifyArgumentMatcher(expectedArgs, args) {\r\n    if (expectedArgs === null) {\r\n        return true;\r\n    }\r\n    if (args.length < expectedArgs.length) {\r\n        return false;\r\n    }\r\n    let isValid = true;\r\n    if (expectedArgs.length === 0) {\r\n        isValid = args.length === 0;\r\n    }\r\n    for (let i = 0; i < expectedArgs.length; i++) {\r\n        const argumentValidator = expectedArgs[i];\r\n        const arg = args[i];\r\n        isValid = isValid && argumentValidator.matches(arg);\r\n    }\r\n    return isValid;\r\n}\r\nexports.verifyArgumentMatcher = verifyArgumentMatcher;\r\nconst defaultExpectationOptions = { includeLocation: true };\r\nfunction buildExpectationString(expectation, options = defaultExpectationOptions) {\r\n    const mockedFuncName = expectation.internalMocker.mockName || \"mock\";\r\n    let argsString = `\\t${mockedFuncName}`;\r\n    if (expectation.expectedArgs === null) {\r\n        argsString += `() with any arguments`;\r\n    }\r\n    else {\r\n        const argData = [];\r\n        for (const argumentValdiatorArg of expectation.expectedArgs) {\r\n            if (argumentValdiatorArg.description) {\r\n                argData.push(argumentValdiatorArg.description());\r\n            }\r\n            else {\r\n                argData.push(argumentValdiatorArg.toString());\r\n            }\r\n        }\r\n        argsString += `(${argData.join(\", \")})`;\r\n    }\r\n    argsString += `. Expected ${expectation.expectedRange.describeRange()}, so far ${expectation.callCount}.`;\r\n    if (options.includeLocation) {\r\n        argsString += `\\n\\tExpectation set at ${expectation.location}`;\r\n    }\r\n    return argsString + \"\\n\";\r\n}\r\nfunction createMockedFunction() {\r\n    const mock = function (...args) {\r\n        const internalMocker = InternalMocker_1.GetInternalMocker(mockedFunc);\r\n        const currentLocation = StackTraceParser_1.StacktraceUtils.getCurrentMockLocation(2);\r\n        internalMocker.recordedInvocations.push({\r\n            params: args,\r\n            location: currentLocation\r\n        });\r\n        const expectationData = findBestArgumentMatcher(internalMocker.expectations, args);\r\n        if (expectationData !== null) {\r\n            if (expectationData.inOrderOverride) {\r\n                const inOrderOverride = expectationData.inOrderOverride;\r\n                const expectedInvocation = inOrderOverride.expectations[inOrderOverride.currentIndex];\r\n                if (expectedInvocation !== expectationData) {\r\n                    const expectedInvocationString = buildExpectationString(expectedInvocation);\r\n                    throw new Error(`Out of order method call.\\nExpected:\\n${expectedInvocationString}\\n` +\r\n                        `Actual:\\n${buildExpectationString(expectationData, { includeLocation: false })}` +\r\n                        `\\tCalled at ${currentLocation}`);\r\n                }\r\n                else {\r\n                    if (inOrderOverride.currentIndex === 0) {\r\n                        internalMocker.inProgressInOrder.push(inOrderOverride);\r\n                    }\r\n                    inOrderOverride.currentIndex++;\r\n                    if (inOrderOverride.currentIndex > inOrderOverride.expectations.length) {\r\n                        const inProgressIndex = internalMocker.inProgressInOrder.indexOf(inOrderOverride);\r\n                        if (inProgressIndex === -1) {\r\n                            throw new Error(\"Could not find in progress index\");\r\n                        }\r\n                        internalMocker.inProgressInOrder.splice(inProgressIndex, 1);\r\n                    }\r\n                }\r\n            }\r\n            else if (internalMocker.inProgressInOrder.length > 0) {\r\n                throw new Error(`Out of order method call.`);\r\n            }\r\n            expectationData.callCount++;\r\n            if (!expectationData.answer) {\r\n                return undefined;\r\n            }\r\n            const result = expectationData.answer(...args);\r\n            return result;\r\n        }\r\n        if (internalMocker.mockType === InternalMocker_1.MockType.Partial) {\r\n            return internalMocker.realFunction.apply(this, args);\r\n        }\r\n        if (internalMocker.options.strictMode === Mock_1.StrictnessMode.Strict) {\r\n            let expectations = \"\";\r\n            for (const expectation of internalMocker.expectations) {\r\n                expectations += buildExpectationString(expectation) + \"\\n\";\r\n            }\r\n            expectations = expectations ? `\\nExpectations:\\n${expectations}\\u00A0` : \"\";\r\n            const wording = internalMocker.expectations.length > 0 ? \"matched\" : \"was set\";\r\n            const argsStringified = [];\r\n            for (const arg of args) {\r\n                argsStringified.push(umbra_util_1.printObject(arg));\r\n            }\r\n            const argsText = argsStringified.join(\", \");\r\n            throw new Error(`${mockedFunc.name}(${argsText}) was called but no expectation ${wording}.${expectations}`);\r\n        }\r\n        return null;\r\n    };\r\n    const mockedFunc = mock;\r\n    return mockedFunc;\r\n}\r\nexports.createMockedFunction = createMockedFunction;\r\n//# sourceMappingURL=MockedFunction.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Range = void 0;\r\nclass Range {\r\n    constructor(start, end = start) {\r\n        if (start < 0) {\r\n            throw new Error(`Start value must be >= 0. Received ${start}`);\r\n        }\r\n        if (end < 1) {\r\n            throw Error(`End value must be >= 1. Received ${end}`);\r\n        }\r\n        if (start > end) {\r\n            throw new Error(`Start must be <= end. Start: ${start} End: ${end}`);\r\n        }\r\n        this.start = start;\r\n        this.end = end;\r\n    }\r\n    isFixedRange() {\r\n        return this.start === this.end;\r\n    }\r\n    isInRange(count) {\r\n        return count >= this.start && count <= this.end;\r\n    }\r\n    hasNoUpperBound() {\r\n        return this.end === Number.MAX_SAFE_INTEGER;\r\n    }\r\n    describeRange() {\r\n        if (this.isFixedRange()) {\r\n            return `${this.start} invocations`;\r\n        }\r\n        if (this.hasNoUpperBound()) {\r\n            return `at least ${this.start} invocations`;\r\n        }\r\n        return `between ${this.start} and ${this.end} invocations`;\r\n    }\r\n}\r\nexports.Range = Range;\r\n//# sourceMappingURL=Range.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.normalizeMatcherArgs = exports.OnGoingStubs = void 0;\r\nconst umbra_util_1 = require(\"@umbra-test/umbra-util\");\r\nconst umbra_assert_1 = require(\"umbra-assert\");\r\nconst InternalMocker_1 = require(\"./InternalMocker\");\r\nconst Range_1 = require(\"./Range\");\r\nconst StackTraceParser_1 = require(\"./StackTraceParser\");\r\nfunction createDirectReturnAnswer(value) {\r\n    return function directReturnAnswer() {\r\n        return value;\r\n    };\r\n}\r\nfunction createDirectThrowAnswer(error) {\r\n    return function directThrowAnswer() {\r\n        throw error;\r\n    };\r\n}\r\nfunction createCallRealMethodAnwser(realFunction) {\r\n    return function realMethodAnswer(...args) {\r\n        return realFunction(args);\r\n    };\r\n}\r\nfunction createPromiseResolveAnswer(value) {\r\n    return function directReturnAnswer() {\r\n        return Promise.resolve(value);\r\n    };\r\n}\r\nfunction createPromiseRejectAnswer(error) {\r\n    return function directReturnAnswer() {\r\n        return Promise.reject(error);\r\n    };\r\n}\r\nfunction normalizeMatcherArgs(args) {\r\n    const normalizedArgs = [];\r\n    for (const arg of args) {\r\n        const argMatcher = InternalMocker_1.GetInternalMockerSafe(arg) === null && typeof arg.matches === \"function\" ? arg : umbra_util_1.eq(arg);\r\n        normalizedArgs.push(argMatcher);\r\n    }\r\n    return normalizedArgs;\r\n}\r\nexports.normalizeMatcherArgs = normalizeMatcherArgs;\r\nconst NOT_SET = -1;\r\nclass OnGoingStubs extends umbra_assert_1.Expect {\r\n    constructor(mockedFunction) {\r\n        super(mockedFunction);\r\n        this.atMostCount = NOT_SET;\r\n        this.atLeastCount = NOT_SET;\r\n        this.timesCount = NOT_SET;\r\n        this.mockedFunction = mockedFunction;\r\n        this.internalMocker = InternalMocker_1.GetInternalMockerSafe(mockedFunction);\r\n        this.currentArgumentExpectations = null;\r\n        if (this.internalMocker) {\r\n            this.internalMocker.isInExpectation = true;\r\n            const expectation = {\r\n                internalMocker: this.internalMocker,\r\n                expectedRange: new Range_1.Range(1),\r\n                location: StackTraceParser_1.StacktraceUtils.getCurrentMockLocation(3),\r\n                answer: null,\r\n                expectedArgs: this.currentArgumentExpectations,\r\n                callCount: 0,\r\n                inOrderOverride: null,\r\n            };\r\n            this.internalMocker.expectations.push(expectation);\r\n            this.expectation = expectation;\r\n        }\r\n        else {\r\n            this.expectation = null;\r\n        }\r\n    }\r\n    getExpectation() {\r\n        if (this.expectation === null) {\r\n            throw new Error(\"Tried to access expectation on an invalid mock\");\r\n        }\r\n        return this.expectation;\r\n    }\r\n    withArgs(...args) {\r\n        if (this.expectation === null) {\r\n            throw new Error(\"Cannot set arguments expectations, an invalid mock object was provided\");\r\n        }\r\n        this.currentArgumentExpectations = normalizeMatcherArgs(args);\r\n        this.expectation.expectedArgs = this.currentArgumentExpectations;\r\n        return this;\r\n    }\r\n    andReturn(value) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createDirectReturnAnswer(value);\r\n        return this;\r\n    }\r\n    andStubReturn(value) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createDirectReturnAnswer(value);\r\n        this.atLeast(0);\r\n    }\r\n    andThrow(error) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createDirectThrowAnswer(error);\r\n        return this;\r\n    }\r\n    andStubThrow(error) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createDirectThrowAnswer(error);\r\n        this.atLeast(0);\r\n    }\r\n    andCallRealMethod() {\r\n        if (this.expectation === null || this.internalMocker === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        const realFunction = this.internalMocker.realFunction;\r\n        if (!realFunction) {\r\n            throw new Error(\"No function was available. Ensure a real object was passed to the spy\");\r\n        }\r\n        this.expectation.answer = createCallRealMethodAnwser(realFunction);\r\n        return this;\r\n    }\r\n    andAnswer(answer) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = answer;\r\n        return this;\r\n    }\r\n    andStubAnswer(answer) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = answer;\r\n        this.atLeast(0);\r\n    }\r\n    andResolve(value) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createPromiseResolveAnswer(value);\r\n        return this;\r\n    }\r\n    andStubResolve(value) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createPromiseResolveAnswer(value);\r\n        this.atLeast(0);\r\n    }\r\n    andReject(error) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createPromiseRejectAnswer(error);\r\n        return this;\r\n    }\r\n    andStubReject(error) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        this.expectation.answer = createPromiseRejectAnswer(error);\r\n        this.atLeast(0);\r\n    }\r\n    times(count) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        if (this.timesCount !== NOT_SET || this.atLeastCount !== NOT_SET || this.atMostCount !== NOT_SET) {\r\n            throw new Error(\"Previously set expectation count, value must only be set once\");\r\n        }\r\n        this.timesCount = count;\r\n        this.setExpectedRange(new Range_1.Range(count));\r\n        return this;\r\n    }\r\n    once() {\r\n        return this.times(1);\r\n    }\r\n    twice() {\r\n        return this.times(2);\r\n    }\r\n    atMost(atMostInvocations) {\r\n        if (this.expectation === null) {\r\n            throw InternalMocker_1.createInvalidMockError(this.mockedFunction);\r\n        }\r\n        if (this.timesCount !== NOT_SET || (this.atMostCount !== NOT_SET && this.atMostCount !== Number.MAX_SAFE_INTEGER)) {\r\n            throw new Error(\"Previously set expectation count, value must only be set once\");\r\n        }\r\n        this.atMostCount = atMostInvocations;\r\n        this.atLeastCount = this.atLeastCount !== NOT_SET ? this.atLeastCount : 0;\r\n        this.setExpectedRange(new Range_1.Range(this.atLeastCount, this.atMostCount));\r\n        return this;\r\n    }\r\n    atLeast(atLeastInvocations) {\r\n        if (this.timesCount !== NOT_SET || (this.atLeastCount !== NOT_SET && this.atLeastCount !== 0)) {\r\n            throw new Error(\"Previously set expectation count, value must only be set once\");\r\n        }\r\n        this.atLeastCount = atLeastInvocations;\r\n        this.atMostCount = this.atMostCount !== NOT_SET ? this.atMostCount : Number.MAX_SAFE_INTEGER;\r\n        this.setExpectedRange(new Range_1.Range(this.atLeastCount, this.atMostCount));\r\n        return this;\r\n    }\r\n    setExpectedRange(range) {\r\n        const expectations = this.internalMocker.expectations;\r\n        if (expectations.length > 1 && range.isFixedRange()) {\r\n            const newExpectations = expectations[expectations.length - 1];\r\n            const lastExpectations = expectations[expectations.length - 2];\r\n            if (!lastExpectations.expectedRange.isFixedRange()) {\r\n                if (this.doArgumentsMatch(lastExpectations, newExpectations)) {\r\n                    throw new Error(\"Previous expectation had a non fixed range.\");\r\n                }\r\n            }\r\n        }\r\n        this.expectation.expectedRange = range;\r\n    }\r\n    doArgumentsMatch(lastExpectations, newExpectations) {\r\n        if (newExpectations.expectedArgs === null || lastExpectations.expectedArgs === null) {\r\n            return lastExpectations.expectedArgs === null && newExpectations.expectedArgs === null;\r\n        }\r\n        if (newExpectations.expectedArgs.length !== lastExpectations.expectedArgs.length) {\r\n            return false;\r\n        }\r\n        for (let i = 0; i < newExpectations.expectedArgs.length; i++) {\r\n            const lastArg = lastExpectations.expectedArgs[i];\r\n            const newArg = newExpectations.expectedArgs[i];\r\n            if (!newArg.equals(lastArg)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\nexports.OnGoingStubs = OnGoingStubs;\r\n//# sourceMappingURL=OnGoingStubs.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.verify = exports.reset = void 0;\r\nconst InternalMocker_1 = require(\"./InternalMocker\");\r\nfunction verify(...mocks) {\r\n    for (const mock of mocks) {\r\n        verifyMock(mock);\r\n    }\r\n}\r\nexports.verify = verify;\r\nfunction reset(...mocks) {\r\n    for (const mock of mocks) {\r\n        resetMock(mock);\r\n    }\r\n}\r\nexports.reset = reset;\r\nfunction resetMock(mock) {\r\n    const internalMocker = InternalMocker_1.GetInternalMocker(mock);\r\n    const test = Object.keys(mock);\r\n    for (const key of test) {\r\n        const value = mock[key];\r\n        if (value) {\r\n            const internalFunctionMocker = InternalMocker_1.GetInternalMockerSafe(value);\r\n            if (internalFunctionMocker) {\r\n                resetMock(value);\r\n            }\r\n        }\r\n    }\r\n    internalMocker.isInExpectation = false;\r\n    clearArray(internalMocker.expectations);\r\n    clearArray(internalMocker.inProgressInOrder);\r\n    clearArray(internalMocker.recordedInvocations);\r\n}\r\nfunction clearArray(array) {\r\n    while (array.length > 0) {\r\n        array.shift();\r\n    }\r\n}\r\nfunction verifyMock(mock) {\r\n    const internalMocker = InternalMocker_1.GetInternalMocker(mock);\r\n    const test = Reflect.ownKeys(mock);\r\n    for (const key of test) {\r\n        const value = Reflect.get(mock, key);\r\n        if (value) {\r\n            const internalFunctionMocker = InternalMocker_1.GetInternalMockerSafe(value);\r\n            if (internalFunctionMocker) {\r\n                verifyMock(value);\r\n            }\r\n        }\r\n    }\r\n    for (const expectation of internalMocker.expectations) {\r\n        if (!expectation.expectedRange.isInRange(expectation.callCount)) {\r\n            throw new Error(buildErrorMessage(internalMocker.recordedInvocations, expectation));\r\n        }\r\n    }\r\n}\r\nfunction buildErrorMessage(args, expectationData) {\r\n    const calledLocations = buildCallLocations(expectationData.expectedArgs, args);\r\n    const specificMessage = buildRangeMessage(expectationData.expectedRange, expectationData.callCount);\r\n    const callLocation = calledLocations.length > 0 ? \"Called at:\\n\" + calledLocations.join(\"\\n\") : \"\";\r\n    return `${specificMessage}\\nExpected at: ${expectationData.location}\\n${callLocation}\\n\\u00A0`;\r\n}\r\nfunction buildRangeMessage(range, callCount) {\r\n    return `Expected ${range.describeRange()}, got ${callCount}.`;\r\n}\r\nfunction buildCallLocations(expectedArgs, args) {\r\n    const callLocations = [];\r\n    for (const invocation of args) {\r\n        if (expectedArgs === null) {\r\n            if (invocation.location !== null) {\r\n                callLocations.push(invocation.location);\r\n            }\r\n        }\r\n    }\r\n    return callLocations;\r\n}\r\n//# sourceMappingURL=Verify.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.createdMocks = void 0;\r\nconst Verify_1 = require(\"./Verify\");\r\nlet createdMocks = null;\r\nexports.createdMocks = createdMocks;\r\nconst umbraTestRunner = global.__testRunner;\r\nif (umbraTestRunner) {\r\n    exports.createdMocks = createdMocks = [];\r\n    umbraTestRunner.on(\"testSuccess\", () => {\r\n        for (const mock of createdMocks) {\r\n            Verify_1.verify(mock);\r\n        }\r\n        exports.createdMocks = createdMocks = [];\r\n    });\r\n    umbraTestRunner.on(\"testFail\", () => {\r\n        exports.createdMocks = createdMocks = [];\r\n    });\r\n    umbraTestRunner.on(\"testTimeout\", () => {\r\n        exports.createdMocks = createdMocks = [];\r\n    });\r\n}\r\n//# sourceMappingURL=UmbraTestRunnerIntegration.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StrictnessMode = exports.setDefaultOptions = exports.expect = exports.staticMock = exports.partialMock = exports.mock = exports.inOrder = void 0;\r\nconst InternalMocker_1 = require(\"./InternalMocker\");\r\nconst MockedFunction_1 = require(\"./MockedFunction\");\r\nconst OnGoingStubs_1 = require(\"./OnGoingStubs\");\r\nconst UmbraTestRunnerIntegration_1 = require(\"./UmbraTestRunnerIntegration\");\r\nconst objectPrototype = Object.prototype;\r\nvar StrictnessMode;\r\n(function (StrictnessMode) {\r\n    StrictnessMode[StrictnessMode[\"Strict\"] = 0] = \"Strict\";\r\n    StrictnessMode[StrictnessMode[\"Loose\"] = 1] = \"Loose\";\r\n})(StrictnessMode || (StrictnessMode = {}));\r\nexports.StrictnessMode = StrictnessMode;\r\nclass InvocationHandler {\r\n    constructor(clazz, mockedFunction, realObject, mockName, options, mockType) {\r\n        this.classPrototype = clazz;\r\n        this.realObject = realObject;\r\n        this.mockName = mockName;\r\n        this.options = options;\r\n        this.mockType = mockType;\r\n        if (this.mockName !== null) {\r\n            Reflect.defineProperty(realObject, \"name\", { value: this.mockName });\r\n        }\r\n        this.internalMocker = InternalMocker_1.CreateInternalMocker(mockedFunction, realObject, this.mockName, this.options, this.mockType);\r\n    }\r\n    apply(target, thisArg, argArray) {\r\n        return target.apply(thisArg, argArray);\r\n    }\r\n    construct(target, argArray, newTarget) {\r\n        if (this.mockType === InternalMocker_1.MockType.Partial) {\r\n            return partialMock(new this.realObject(...argArray));\r\n        }\r\n        return {};\r\n    }\r\n    get(target, p, receiver) {\r\n        if (p === InternalMocker_1.INTERNAL_MOCKER_NAME) {\r\n            return this.internalMocker;\r\n        }\r\n        let realValue = Reflect.get(this.realObject, p, receiver);\r\n        if (realValue !== undefined) {\r\n            if (typeof realValue !== \"function\" || this.mockType !== InternalMocker_1.MockType.Partial || InternalMocker_1.GetInternalMockerSafe(realValue) !== null) {\r\n                return realValue;\r\n            }\r\n        }\r\n        if (this.classPrototype && realValue === undefined) {\r\n            const propertyDescriptor = this.getPropertyDescriptor(this.classPrototype, p);\r\n            if (propertyDescriptor !== undefined) {\r\n                realValue = propertyDescriptor.value;\r\n            }\r\n            else if (this.mockType === InternalMocker_1.MockType.Instance) {\r\n                return undefined;\r\n            }\r\n        }\r\n        if (this.realObject instanceof Promise && p === \"then\") {\r\n            realValue = realValue.bind(this.realObject);\r\n        }\r\n        let newCachedField;\r\n        const mockName = this.mockName !== null ? `${this.mockName}.${p.toString()}` : p.toString();\r\n        switch (this.mockType) {\r\n            case InternalMocker_1.MockType.Instance:\r\n                newCachedField = mock(realValue, mockName);\r\n                break;\r\n            case InternalMocker_1.MockType.Static:\r\n            case InternalMocker_1.MockType.Partial:\r\n                if (!realValue) {\r\n                    return realValue;\r\n                }\r\n                newCachedField = partialMock(realValue);\r\n                break;\r\n            default:\r\n                throw new Error(\"Unknown mock type \" + InternalMocker_1.MockType[this.mockType]);\r\n        }\r\n        Reflect.set(this.realObject, p, newCachedField);\r\n        return newCachedField;\r\n    }\r\n    deleteProperty(target, p) {\r\n        return Reflect.deleteProperty(this.realObject, p);\r\n    }\r\n    set(target, p, value, receiver) {\r\n        return Reflect.set(this.realObject, p, value, receiver);\r\n    }\r\n    ownKeys(target) {\r\n        let normalTargetKeys = Reflect.ownKeys(target);\r\n        if (this.mockType === InternalMocker_1.MockType.Static) {\r\n            normalTargetKeys = normalTargetKeys.concat(Reflect.ownKeys(this.classPrototype));\r\n        }\r\n        const resultKeys = Reflect.ownKeys(this.realObject);\r\n        const internalMockIndex = resultKeys.indexOf(InternalMocker_1.INTERNAL_MOCKER_NAME);\r\n        if (internalMockIndex !== -1) {\r\n            resultKeys.splice(internalMockIndex, 1);\r\n        }\r\n        for (const key of normalTargetKeys) {\r\n            if (key === InternalMocker_1.INTERNAL_MOCKER_NAME) {\r\n                continue;\r\n            }\r\n            if (resultKeys.indexOf(key) === -1) {\r\n                resultKeys.push(key);\r\n            }\r\n        }\r\n        return resultKeys;\r\n    }\r\n    getOwnPropertyDescriptor(target, p) {\r\n        const descriptor = Reflect.getOwnPropertyDescriptor(target, p);\r\n        if (descriptor !== undefined) {\r\n            return descriptor;\r\n        }\r\n        return Reflect.getOwnPropertyDescriptor(this.realObject, p);\r\n    }\r\n    getPropertyDescriptor(object, propertyKey) {\r\n        if (!object) {\r\n            return undefined;\r\n        }\r\n        let searchTarget = object;\r\n        while (searchTarget !== objectPrototype) {\r\n            const propertyDescriptor = Reflect.getOwnPropertyDescriptor(searchTarget, propertyKey);\r\n            if (propertyDescriptor !== undefined) {\r\n                return propertyDescriptor;\r\n            }\r\n            searchTarget = Reflect.getPrototypeOf(searchTarget);\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nlet defaultOptions = {\r\n    strictMode: StrictnessMode.Strict,\r\n    inOrder: false\r\n};\r\nfunction setDefaultOptions(options) {\r\n    defaultOptions = Object.assign(defaultOptions, options);\r\n}\r\nexports.setDefaultOptions = setDefaultOptions;\r\nfunction mock(clazz, mockName, options = defaultOptions) {\r\n    const stubFunction = MockedFunction_1.createMockedFunction();\r\n    if (typeof clazz === \"string\") {\r\n        mockName = clazz;\r\n        clazz = undefined;\r\n    }\r\n    if (!mockName) {\r\n        mockName = null;\r\n    }\r\n    const proxy = new Proxy(stubFunction, new InvocationHandler(clazz ? clazz.prototype : null, stubFunction, stubFunction, mockName, options, InternalMocker_1.MockType.Instance));\r\n    if (UmbraTestRunnerIntegration_1.createdMocks) {\r\n        UmbraTestRunnerIntegration_1.createdMocks.push(proxy);\r\n    }\r\n    return proxy;\r\n}\r\nexports.mock = mock;\r\nfunction staticMock(clazz) {\r\n    const stubFunction = MockedFunction_1.createMockedFunction();\r\n    return new Proxy(stubFunction, new InvocationHandler(clazz, stubFunction, stubFunction, null, defaultOptions, InternalMocker_1.MockType.Static));\r\n}\r\nexports.staticMock = staticMock;\r\nfunction partialMock(realObject, mockName = null, options = defaultOptions) {\r\n    const stubFunction = (typeof realObject === \"function\" ? MockedFunction_1.createMockedFunction() : {});\r\n    return new Proxy(stubFunction, new InvocationHandler(Object.getPrototypeOf(realObject), stubFunction, realObject, mockName, options, InternalMocker_1.MockType.Partial));\r\n}\r\nexports.partialMock = partialMock;\r\nfunction expect(mockedFunction) {\r\n    return new OnGoingStubs_1.OnGoingStubs(mockedFunction);\r\n}\r\nexports.expect = expect;\r\nfunction inOrder(...stubs) {\r\n    const inOrderExpectation = {\r\n        expectations: [],\r\n        currentIndex: 0\r\n    };\r\n    const castStubs = stubs;\r\n    for (const castStub of castStubs) {\r\n        const expectation = castStub.getExpectation();\r\n        inOrderExpectation.expectations.push(expectation);\r\n        expectation.inOrderOverride = inOrderExpectation;\r\n    }\r\n}\r\nexports.inOrder = inOrder;\r\n//# sourceMappingURL=Mock.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.newCapture = exports.matcher = exports.regexMatches = exports.startsWith = exports.lte = exports.lt = exports.gte = exports.gt = exports.eq = exports.any = exports.setDefaultOptions = exports.inOrder = exports.verify = exports.reset = exports.expect = exports.staticMock = exports.partialMock = exports.mock = void 0;\r\nconst umbra_util_1 = require(\"@umbra-test/umbra-util\");\r\nObject.defineProperty(exports, \"any\", { enumerable: true, get: function () { return umbra_util_1.any; } });\r\nObject.defineProperty(exports, \"eq\", { enumerable: true, get: function () { return umbra_util_1.eq; } });\r\nObject.defineProperty(exports, \"gt\", { enumerable: true, get: function () { return umbra_util_1.gt; } });\r\nObject.defineProperty(exports, \"gte\", { enumerable: true, get: function () { return umbra_util_1.gte; } });\r\nObject.defineProperty(exports, \"lt\", { enumerable: true, get: function () { return umbra_util_1.lt; } });\r\nObject.defineProperty(exports, \"lte\", { enumerable: true, get: function () { return umbra_util_1.lte; } });\r\nObject.defineProperty(exports, \"matcher\", { enumerable: true, get: function () { return umbra_util_1.matcher; } });\r\nObject.defineProperty(exports, \"regexMatches\", { enumerable: true, get: function () { return umbra_util_1.regexMatches; } });\r\nObject.defineProperty(exports, \"startsWith\", { enumerable: true, get: function () { return umbra_util_1.startsWith; } });\r\nconst Capture_1 = require(\"./Capture\");\r\nObject.defineProperty(exports, \"newCapture\", { enumerable: true, get: function () { return Capture_1.newCapture; } });\r\nconst Mock_1 = require(\"./Mock\");\r\nObject.defineProperty(exports, \"expect\", { enumerable: true, get: function () { return Mock_1.expect; } });\r\nObject.defineProperty(exports, \"inOrder\", { enumerable: true, get: function () { return Mock_1.inOrder; } });\r\nObject.defineProperty(exports, \"mock\", { enumerable: true, get: function () { return Mock_1.mock; } });\r\nObject.defineProperty(exports, \"partialMock\", { enumerable: true, get: function () { return Mock_1.partialMock; } });\r\nObject.defineProperty(exports, \"setDefaultOptions\", { enumerable: true, get: function () { return Mock_1.setDefaultOptions; } });\r\nObject.defineProperty(exports, \"staticMock\", { enumerable: true, get: function () { return Mock_1.staticMock; } });\r\nconst Verify_1 = require(\"./Verify\");\r\nObject.defineProperty(exports, \"reset\", { enumerable: true, get: function () { return Verify_1.reset; } });\r\nObject.defineProperty(exports, \"verify\", { enumerable: true, get: function () { return Verify_1.verify; } });\r\nrequire(\"./UmbraTestRunnerIntegration\");\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TestRunner = exports.staticMock = exports.startsWith = exports.setMockOptions = exports.reset = exports.regexMatches = exports.partialMock = exports.newCapture = exports.matcher = exports.lte = exports.lt = exports.inOrder = exports.gte = exports.gt = exports.eq = exports.any = exports.verify = exports.mock = exports.assert = exports.expect = void 0;\r\nrequire(\"umbra-cli/lib/StartupStages/ExportGlobals\");\r\nconst umbra_test_runner_1 = require(\"@umbra-test/umbra-test-runner\");\r\nObject.defineProperty(exports, \"TestRunner\", { enumerable: true, get: function () { return umbra_test_runner_1.TestRunner; } });\r\nconst umbra_assert_1 = require(\"umbra-assert\");\r\nObject.defineProperty(exports, \"assert\", { enumerable: true, get: function () { return umbra_assert_1.assert; } });\r\nconst umbra_test_mock_1 = require(\"umbra-test-mock\");\r\nObject.defineProperty(exports, \"any\", { enumerable: true, get: function () { return umbra_test_mock_1.any; } });\r\nObject.defineProperty(exports, \"eq\", { enumerable: true, get: function () { return umbra_test_mock_1.eq; } });\r\nObject.defineProperty(exports, \"expect\", { enumerable: true, get: function () { return umbra_test_mock_1.expect; } });\r\nObject.defineProperty(exports, \"gt\", { enumerable: true, get: function () { return umbra_test_mock_1.gt; } });\r\nObject.defineProperty(exports, \"gte\", { enumerable: true, get: function () { return umbra_test_mock_1.gte; } });\r\nObject.defineProperty(exports, \"inOrder\", { enumerable: true, get: function () { return umbra_test_mock_1.inOrder; } });\r\nObject.defineProperty(exports, \"lt\", { enumerable: true, get: function () { return umbra_test_mock_1.lt; } });\r\nObject.defineProperty(exports, \"lte\", { enumerable: true, get: function () { return umbra_test_mock_1.lte; } });\r\nObject.defineProperty(exports, \"matcher\", { enumerable: true, get: function () { return umbra_test_mock_1.matcher; } });\r\nObject.defineProperty(exports, \"mock\", { enumerable: true, get: function () { return umbra_test_mock_1.mock; } });\r\nObject.defineProperty(exports, \"newCapture\", { enumerable: true, get: function () { return umbra_test_mock_1.newCapture; } });\r\nObject.defineProperty(exports, \"partialMock\", { enumerable: true, get: function () { return umbra_test_mock_1.partialMock; } });\r\nObject.defineProperty(exports, \"regexMatches\", { enumerable: true, get: function () { return umbra_test_mock_1.regexMatches; } });\r\nObject.defineProperty(exports, \"reset\", { enumerable: true, get: function () { return umbra_test_mock_1.reset; } });\r\nObject.defineProperty(exports, \"setMockOptions\", { enumerable: true, get: function () { return umbra_test_mock_1.setDefaultOptions; } });\r\nObject.defineProperty(exports, \"startsWith\", { enumerable: true, get: function () { return umbra_test_mock_1.startsWith; } });\r\nObject.defineProperty(exports, \"staticMock\", { enumerable: true, get: function () { return umbra_test_mock_1.staticMock; } });\r\nObject.defineProperty(exports, \"verify\", { enumerable: true, get: function () { return umbra_test_mock_1.verify; } });\r\n//# sourceMappingURL=index.js.map"],"names":["Object","defineProperty","exports","value","[object Object]","fn","name","writable","length","Promise","resolve","reject","result","Error","e","TimeoutError","message","elapsedMs","timeoutMs","super","this","promise","startTime","Date","now","timerId","timeoutPromise","setTimeout","catch","clearTimeout","race","then","to","from","entryType","stopOnFirstFail","union","arrayA","arrayB","item","indexOf","push","without","array","indexOfItem","splice","onListeners","onceListeners","event","callback","args","call","promises","all","results","queue","element","stack","unshift","pop","shift","i","j","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","apply","QueueStackTypes","config","eventEmitter","SimpleEventEmitter_1","SimpleEventEmitter","asyncPromisifier","AsyncPromisifier_1","AsyncPromisifier","timeoutPromisifier","TimeoutPromisifier_1","TimeoutPromisifier","testQueueStack","queueStacks","before","QueueStack_1","QueueStack","beforeEach","after","afterEach","currentTest","testRunCancelled","describe","title","execBlock","throwIfTestInProgress","pushToCurrentTestQueue","describeOnly","describeSkip","options","undefined","it","itOnly","itSkip","runNextTestQueue","evaluatedTest","firstOnlyIndex","executeTest","tests","evaluateQueueWithTimeout","resetRunResults","runResults","elapsedTimeMs","totalTests","totalSuccesses","totalFailures","totalTimeouts","testResults","TestRunnerConfig_1","mergeConfig","DefaultTestRunnerConfig_1","DefaultTestRunnerConfig","only","skip","absolutePath","lastFilePathSet","on","once","off","pushOnBottomStack","pushOnTopStack","currentRun","type","reset","testQueue","describeTitleChain","evaluatedBefores","skipAllTests","currentEntry","testEntry","absoluteFilePath","entry","currentlyExecutingFilePath","evaluateDescribe","evaluateTest","concat","pushStack","unshiftStack","exec","popStack","shiftStack","testInfo","emit","executeTestCallback","timeoutValue","getTimeoutValue","wrap","error","emitAndWaitForCompletion","evaluateQueue","traverseLevelOrder","timeout","enumerable","get","TestRunner_1","TestRunner","deepEqual","a","b","getTime","exists","key","aKeys","bKeys","prototype","keys","sort","deepEqualObject","ArrayUtils_1","compareDefault","compare","initialValues","compareFunction","insert","foundIndex","searchInternal","highestIndex","index","search","ordering","high","low","Math","floor","object","RegExp","toString","mockerData","mock","internalMocker","GetMockerDataSafe","mockName","JSON","stringify","validator","precedence","matches","description","equals","other","realValue","Stringify_1","printObject","DeepEqual_1","startsWith","test","func","SortedArray_1","SortedArray","ArgumentValidator_1","any","eq","gt","gte","lt","lte","matcher","regexMatches","INTERNAL_MOCKER_NAME","AssertionError","ourMessage","theirMessage","assert","output","expected","actual","umbra_util_1","is","strictEqual","target","keyPath","pathArray","split","path","newResult","fail","actualValue","equal","errorMessage","notEqual","isTrue","Array","isArray","entryKey","entryValue","entries","values","contains","snapshot","snapshotString","Expect","Assert_1","has","isTruthy","isFalsy","Expect_1","expect","printString","String","replace","alreadySeenObjects","printObjectCapture","objectCaptured","indent","toISOString","typeofObject","arrayData","join","substr","Reflect","ownKeys","keyStrings","CaptureInternal","first","last","arg","MockType","GetInternalMockerSafe","createInvalidMockError","mockedFunction","realFunction","mockType","expectations","recordedInvocations","inProgressInOrder","isInExpectation","depth","stackTrace","stackTraceLines","callingLocation","findBestArgumentMatcher","argumentMatcherArray","inOrderOverride","expectedArgs","argLengthDifference","aMatcherPrecedence","sumMatchers","expectation","getData","callCount","expectedRange","end","verifyArgumentMatcher","sum","isValid","argumentValidator","defaultExpectationOptions","includeLocation","buildExpectationString","argsString","argData","argumentValdiatorArg","describeRange","location","mockedFunc","InternalMocker_1","GetInternalMocker","currentLocation","StackTraceParser_1","StacktraceUtils","getCurrentMockLocation","params","expectationData","expectedInvocation","currentIndex","expectedInvocationString","inProgressIndex","answer","Partial","strictMode","Mock_1","StrictnessMode","Strict","wording","argsStringified","argsText","start","count","Number","MAX_SAFE_INTEGER","isFixedRange","hasNoUpperBound","createDirectReturnAnswer","createDirectThrowAnswer","createPromiseResolveAnswer","createPromiseRejectAnswer","normalizeMatcherArgs","normalizedArgs","argMatcher","OnGoingStubs","umbra_assert_1","atMostCount","atLeastCount","timesCount","currentArgumentExpectations","Range_1","Range","atLeast","createCallRealMethodAnwser","setExpectedRange","times","atMostInvocations","atLeastInvocations","range","newExpectations","lastExpectations","doArgumentsMatch","lastArg","resetMock","clearArray","verifyMock","isInRange","buildErrorMessage","calledLocations","callLocations","invocation","buildCallLocations","specificMessage","callLocation","mocks","createdMocks","umbraTestRunner","global","__testRunner","Verify_1","verify","objectPrototype","InvocationHandler","clazz","realObject","classPrototype","CreateInternalMocker","argArray","newTarget","partialMock","p","receiver","newCachedField","propertyDescriptor","getPropertyDescriptor","Instance","bind","Static","set","deleteProperty","normalTargetKeys","resultKeys","internalMockIndex","descriptor","getOwnPropertyDescriptor","propertyKey","searchTarget","getPrototypeOf","defaultOptions","inOrder","stubFunction","MockedFunction_1","createMockedFunction","proxy","Proxy","UmbraTestRunnerIntegration_1","assign","OnGoingStubs_1","stubs","inOrderExpectation","castStubs","castStub","getExpectation","Capture_1","newCapture","setDefaultOptions","staticMock","umbra_test_runner_1","umbra_test_mock_1"],"mappings":"iZACAA,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,wBAA2B,EA4C3BA,mBAxCA,MAYIE,KAAKC,EAAIC,GAML,GALAN,OAAOC,eAAeI,EAAI,OAAQ,CAAEF,MAAOG,EAAMC,UAAU,IAKzC,IAAdF,EAAGG,OACH,OAAO,IAAIC,QAAQ,CAACC,EAASC,KACzBN,EAAIO,IACIA,aAAkBC,MAClBF,EAAOC,GAGPF,EAAQE,OAMpB,IACI,OAAOH,QAAQC,QAAQL,KAE3B,MAAOS,GACH,OAAOL,QAAQE,OAAOG,wDCxCtCd,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,qBAA6BA,oBAAuB,EAIpD,MAAMa,UAAqBF,MACvBT,YAAYY,EAASC,EAAWC,GAC5BC,MAAMH,GACNI,KAAKF,UAAYA,GAGzBhB,eAAuBa,EAoCvBb,qBA/BA,MASIE,KAAKiB,EAASH,GACV,GAAIA,GAAa,EACb,OAAOG,EAEX,MAAMC,EAAYC,KAAKC,MACvB,IAAIC,EAAU,KACd,MAAMC,EAAiB,IAAIjB,QAAQ,CAACC,EAASC,KACzCc,EAAUE,WAAW,KACjB,MAAMV,EAAYM,KAAKC,MAAQF,EAC/BX,EAAO,IAAII,EAAa,yCAAyCE,eAAuBC,OAAgBD,EAAWC,KACpHA,KAMP,OAJAG,EAAQO,MAAM,KACVC,aAAaJ,KAGVhB,QAAQqB,KAAK,CAACT,EAASK,IAAiBK,KAAMnB,IACjDiB,aAAaJ,GACNb,yEC3CnBZ,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,mBAAsB,EA0BtBA,cAnBA,SAAqB8B,EAAIC,GACrB,IAAKA,GAAwB,iBAATA,EAChB,OAAOD,EAEX,GAA4B,iBAAjBA,EAAGd,WAAoD,iBAAnBe,EAAKf,UAChD,IAAK,MAAMgB,IAAa,CAAC,KAAM,SAAU,aAAc,QAAS,aACnB,iBAA9BD,EAAKf,UAAUgB,KACtBF,EAAGd,UAAUgB,GAAaD,EAAKf,UAAUgB,cAIlB,IAAnBD,EAAKf,YACjBc,EAAGd,UAAYe,EAAKf,WAKxB,OAHIc,EAAGG,kBAAoBF,EAAKE,kBAC5BH,EAAGG,gBAAkBF,EAAKE,iBAEvBH,gDCzBXhC,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,+BAAkC,EAQlCA,0BAJgC,CAC5BgB,UAAW,IACXiB,iBAAiB,4DCIrB,SAASC,EAAMC,EAAQC,GACnB,IAAKD,EACD,OAAOC,GAAkB,GAE7B,IAAKA,EACD,OAAOD,EAEX,IAAK,MAAME,KAAQD,GACe,IAA1BD,EAAOG,QAAQD,IACfF,EAAOI,KAAKF,GAGpB,OAAOF,EAcX,SAASK,EAAQC,EAAOJ,GACpB,IAAKI,EACD,MAAO,GAEX,MAAMC,EAAcD,EAAMH,QAAQD,GAIlC,OAHqB,IAAjBK,GACAD,EAAME,OAAOD,EAAa,GAEvBD,EA7CX3C,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,UAAkBA,QAAgBA,0BAA6B,EAwB/DA,QAAgBkC,EAsBhBlC,UAAkBwC,EAwElBxC,qBAlEA,MACIE,cAEIgB,KAAK0B,YAAc,GACnB1B,KAAK2B,cAAgB,GAEzB3C,GAAG4C,EAAOC,GACL7B,KAAK0B,YAAYE,GAAUZ,EAAMhB,KAAK0B,YAAYE,GAAQ,CAACC,IAEhE7C,KAAK4C,EAAOC,GACR7B,KAAK2B,cAAcC,GAASZ,EAAMhB,KAAK2B,cAAcC,GAAQ,CAACC,IAElE7C,IAAI4C,EAAOC,GACP7B,KAAK0B,YAAYE,GAASN,EAAQtB,KAAK0B,YAAYE,GAAQC,GAC3D7B,KAAK2B,cAAcC,GAASN,EAAQtB,KAAK2B,cAAcC,GAAQC,GAEnE7C,KAAK4C,KAAUE,GACX,GAAI9B,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpCC,EAASE,KAAK,QAASD,GAG/B,GAAI9B,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtCC,EAASE,KAAK,QAASD,GAE3B9B,KAAK2B,cAAcC,GAAS,IAWpC5C,yBAAyB4C,KAAUE,GAC/B,MAAME,EAAW,GACjB,GAAIhC,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAIzC,GAAIM,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAGrCM,KAAK2B,cAAcC,GAAS,GAEhC,OAAOvC,QAAQ4C,IAAID,GAAUrB,KAAMuB,+ECjH3CtD,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,kBAAqB,EAmGrBA,aA/FA,MACIE,cACIgB,KAAKmC,MAAQ,GAOjBnD,eAAeoD,GACe,IAAtBpC,KAAKmC,MAAM/C,OACXY,KAAKmC,MAAMd,KAAK,CAACe,IAGjBpC,KAAKmC,MAAM,GAAGd,KAAKe,GAQ3BpD,kBAAkBoD,GACY,IAAtBpC,KAAKmC,MAAM/C,OACXY,KAAKmC,MAAMd,KAAK,CAACe,IAGjBpC,KAAKmC,MAAMnC,KAAKmC,MAAM/C,OAAS,GAAGiC,KAAKe,GAQ/CpD,UAAUqD,GACNrC,KAAKmC,MAAMd,KAAKgB,GAOpBrD,aAAaqD,GACTrC,KAAKmC,MAAMG,QAAQD,GAKvBrD,WACI,OAAOgB,KAAKmC,MAAMI,MAKtBvD,aACI,OAAOgB,KAAKmC,MAAMK,QAOtBxD,mBAAmB6C,GACf,IAAI5B,EAAUZ,QAAQC,UACtB,IAAK,IAAImD,EAAI,EAAGA,EAAIzC,KAAKmC,MAAM/C,OAAQqD,IAAK,CACxC,MAAMN,EAAQnC,KAAKmC,MAAMM,GACzB,IAAK,IAAIC,EAAI,EAAGA,EAAIP,EAAM/C,OAAQsD,IAC9BzC,EAAUA,EAAQU,KAAK,IAAMkB,EAASM,EAAMO,KAGpD,OAAOzC,EAOXjB,0BAA0B6C,GACtB,IAAI5B,EAAUZ,QAAQC,UACtB,IAAK,IAAImD,EAAIzC,KAAKmC,MAAM/C,OAAS,EAAGqD,GAAK,EAAGA,IAAK,CAC7C,MAAMN,EAAQnC,KAAKmC,MAAMM,GACzB,IAAK,IAAIC,EAAIP,EAAM/C,OAAS,EAAGsD,GAAK,EAAGA,IACnCzC,EAAUA,EAAQU,KAAK,IAAMkB,EAASM,EAAMO,KAGpD,OAAOzC,EAKXjB,QACIgB,KAAKmC,MAAQ,iDCjGrB,IAAIQ,EAAa3C,GAAQA,EAAK2C,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIzD,WAAU,SAAUC,EAASC,GAC/C,SAASyD,EAAUjE,GAAS,IAAMkE,EAAKF,EAAUG,KAAKnE,IAAW,MAAOW,GAAKH,EAAOG,IACpF,SAASyD,EAASpE,GAAS,IAAMkE,EAAKF,EAAiB,MAAEhE,IAAW,MAAOW,GAAKH,EAAOG,IACvF,SAASuD,EAAKzD,GAJlB,IAAeT,EAIaS,EAAO4D,KAAO9D,EAAQE,EAAOT,QAJ1CA,EAIyDS,EAAOT,MAJhDA,aAAiB+D,EAAI/D,EAAQ,IAAI+D,GAAE,SAAUxD,GAAWA,EAAQP,OAIT4B,KAAKqC,EAAWG,GAClGF,GAAMF,EAAYA,EAAUM,MAAMT,EAASC,GAAc,KAAKK,YAGtEtE,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,kBAAqB,EAOrB,MAAMwE,EAAkB,CAAC,SAAU,aAAc,QAAS,aA6U1DxE,aAzUA,MACIE,YAAYuE,EAAQC,EAAe,IAAIC,EAAqBC,oBACxD1D,KAAK2D,iBAAmB,IAAIC,EAAmBC,iBAC/C7D,KAAK8D,mBAAqB,IAAIC,EAAqBC,mBACnDhE,KAAKiE,eAAiB,GACtBjE,KAAKkE,YAAc,CACfC,OAAU,IAAIC,EAAaC,WAC3BC,WAAc,IAAIF,EAAaC,WAC/BE,MAAS,IAAIH,EAAaC,WAC1BG,UAAa,IAAIJ,EAAaC,YAElCrE,KAAKyE,YAAc,KACnBzE,KAAK0E,kBAAmB,EAExB1E,KAAK2E,UAAaC,EAAOC,KACrB7E,KAAK8E,sBAAsB,YAC3B9E,KAAK+E,uBAAuB,WAAYH,EAAOC,IAEnD7E,KAAKgF,aAAe,CAACJ,EAAOC,KACxB7E,KAAK8E,sBAAsB,iBAC3B9E,KAAK+E,uBAAuB,WAAYH,EAAOC,GAAW,IAE9D7E,KAAKiF,aAAe,CAACL,EAAOC,EAAWK,KACnClF,KAAK8E,sBAAsB,iBAC3B9E,KAAK+E,uBAAuB,WAAYH,EAAOC,GAAW,OAAOM,GAAW,IAEhFnF,KAAKoF,IAAOR,EAAOC,EAAWK,KAC1BlF,KAAK8E,sBAAsB,MAC3B9E,KAAK+E,uBAAuB,KAAMH,EAAOC,GAAW,EAAOK,EAAUA,EAAQpF,eAAYqF,IAE7FnF,KAAKqF,OAAS,CAACT,EAAOC,EAAWK,KAC7BlF,KAAK8E,sBAAsB,WAC3B9E,KAAK+E,uBAAuB,KAAMH,EAAOC,GAAW,EAAMK,EAAUA,EAAQpF,eAAYqF,IAE5FnF,KAAKsF,OAAS,CAACV,EAAOC,EAAWK,KAC7BlF,KAAK8E,sBAAsB,WAC3B9E,KAAK+E,uBAAuB,KAAMH,EAAOC,GAAW,OAAOM,GAAW,IAE1EnF,KAAKuF,iBAAmB,IAAM5C,EAAU3C,UAAM,OAAQ,GAAQ,YAC1D,GAAmC,IAA/BA,KAAKiE,eAAe7E,OACpB,OAEJ,IAAIoG,GAAgB,EACpB,MAAMrD,EAAQnC,KAAKiE,eAAezB,QAClC,GAA6B,OAAzBL,EAAMsD,eACND,QAAsBxF,KAAK0F,YAAYvD,EAAOA,EAAMwD,MAAMxD,EAAMsD,sBAGhE,IAAK,IAAIhD,EAAI,EAAGA,EAAIN,EAAMwD,MAAMvG,OAAQqD,IACpC+C,SAAuBxF,KAAK0F,YAAYvD,EAAOA,EAAMwD,MAAMlD,MAAQ+C,EAGvEA,UACMxF,KAAK4F,yBAAyB,aAG5C5F,KAAK8E,sBAAyB5F,IAC1B,GAAIc,KAAKyE,YACL,MAAM,IAAIhF,MAAM,iBAAiBP,oCAGzCc,KAAK6F,gBAAkB,KACnB7F,KAAK8F,WAAa,CACdC,cAAe,EACfC,WAAY,EACZC,eAAgB,EAChBC,cAAe,EACfC,cAAe,EACfC,YAAa,KAGrBpG,KAAKuD,OAAS8C,EAAmBC,YAAYC,EAA0BC,wBAAyBjD,GAChGvD,KAAKwD,aAAeA,EACpBxD,KAAKoF,GAAGqB,KAAOzG,KAAKqF,OACpBrF,KAAK2E,SAAS8B,KAAOzG,KAAKgF,aAC1BhF,KAAKoF,GAAGsB,KAAO1G,KAAKsF,OACpBtF,KAAK2E,SAAS+B,KAAO1G,KAAKiF,aAC1BjF,KAAK6F,kBAMT7G,eAAe2H,GACX3G,KAAK4G,gBAAkBD,EAE3B3H,GAAG4C,EAAOC,GACN7B,KAAKwD,aAAaqD,GAAGjF,EAAOC,GAEhC7C,KAAK4C,EAAOC,GACR7B,KAAKwD,aAAasD,KAAKlF,EAAOC,GAElC7C,IAAI4C,EAAOC,GACP7B,KAAKwD,aAAauD,IAAInF,EAAOC,GAEjC7C,OAAO6F,GACH7E,KAAK8E,sBAAsB,UAC3B9E,KAAKkE,YAAoB,OAAE8C,kBAAkBnC,GAEjD7F,WAAW6F,GACP7E,KAAK8E,sBAAsB,cAC3B9E,KAAKkE,YAAwB,WAAE8C,kBAAkBnC,GAErD7F,MAAM6F,GACF7E,KAAK8E,sBAAsB,SAC3B9E,KAAKkE,YAAmB,MAAE+C,eAAepC,GAE7C7F,UAAU6F,GACN7E,KAAK8E,sBAAsB,aAC3B9E,KAAKkE,YAAuB,UAAE+C,eAAepC,GAOjD7F,MACI,GAAIgB,KAAKkH,WACL,MAAM,IAAIzH,MAAM,yDAEpB,MAAMS,EAAYC,KAAKC,MAWvB,OAVAJ,KAAKkH,WAAalH,KAAKuF,mBAAmB5E,KAAK,KAC3C,MAAMuB,EAAUlC,KAAK8F,WAIrB,OAHA5D,EAAQ6D,cAAgB5F,KAAKC,MAAQF,EACrCF,KAAKkH,WAAa,KAClBlH,KAAK6F,kBACE3D,IACR1B,MAAOd,IAEN,MADAM,KAAKkH,WAAa,KACZxH,IAEHM,KAAKkH,WAOhBlI,qBACI,IAAKgB,KAAKyE,YACN,MAAM,IAAIhF,MAAM,oDAEpB,OAAOO,KAAKyE,YAOhBzF,QACI,GAAIgB,KAAKkH,WACL,MAAM,IAAIzH,MAAM,qDAEpBO,KAAK6F,kBACL7F,KAAK0E,kBAAmB,EACxB1E,KAAKiE,eAAiB,GACtB,IAAK,MAAMkD,KAAQ7D,EACftD,KAAKkE,YAAYiD,GAAMC,QAG/BpI,SACI,OAAKgB,KAAKkH,YAGVlH,KAAK0E,kBAAmB,EACjB1E,KAAKkH,WAAWvG,KAAMuB,IACzBlC,KAAKoH,QACElF,KALA7C,QAAQE,OAAO,IAAIE,MAAM,sEAQxCT,uBAAuBmI,EAAMvC,EAAOC,EAAW4B,EAAM3G,EAAW4G,GAC5D,GAAmC,IAA/B1G,KAAKiE,eAAe7E,OAAc,CAClC,MAAMiI,EAAY,CACdC,mBAAoB,GACpB3B,MAAO,GACP4B,kBAAkB,EAClBC,aAAuB,aAATL,GAAuBT,EACrCjB,eAAgBgB,EAAO,EAAI,MAE/BzG,KAAKiE,eAAe5C,KAAKgG,GAE7B,MAAMI,EAAezH,KAAKiE,eAAejE,KAAKiE,eAAe7E,OAAS,GAChEsI,EAAY,CACdP,KAAMA,EACNtF,SAAUgD,EACVyC,mBAAoBG,EAAaH,mBACjC1C,MAAOA,EACP+C,iBAAkB3H,KAAK4G,gBACvBF,KAAMA,GAAQe,EAAaD,cAE3Bf,GAAwC,OAAhCgB,EAAahC,iBACrBgC,EAAahC,eAAiBgC,EAAa9B,MAAMvG,QAEjDU,EAAY,IACZ4H,EAAU5H,UAAYA,GAE1B2H,EAAa9B,MAAMtE,KAAKqG,GAE5B1I,YAAYmD,EAAOyF,GACf,OAAOjF,EAAU3C,UAAM,OAAQ,GAAQ,YAInC,OAHI4H,EAAMD,mBAAqB3H,KAAK6H,6BAChC7H,KAAK6H,2BAA6BD,EAAMD,mBAExC3H,KAAK0E,mBAGe,aAAfkD,EAAMT,KACJnH,KAAK8H,iBAAiB3F,EAAOyF,GAG7B5H,KAAK+H,aAAa5F,EAAOyF,OAI5C5I,iBAAiBmD,EAAOyF,GACpB,OAAOjF,EAAU3C,UAAM,OAAQ,GAAQ,YACnCA,KAAKiE,eAAe5C,KAAK,CACrBiG,mBAAoB,GAAGU,OAAO7F,EAAMmF,mBAAoBM,EAAMhD,OAC9De,MAAO,GACP4B,kBAAkB,EAClBC,aAAcI,EAAMlB,KACpBjB,eAAgB,OAEpB,IAAK,MAAM0B,KAAQ7D,EACF,WAAT6D,GAA8B,eAATA,EACrBnH,KAAKkE,YAAYiD,GAAMc,UAAU,IAGjCjI,KAAKkE,YAAYiD,GAAMe,aAAa,UAGtClI,KAAK2D,iBAAiBwE,KAAKP,EAAM/F,SAAU,kBAC3C7B,KAAKuF,mBACX,IAAK,MAAM4B,KAAQ7D,EACF,WAAT6D,GAA8B,eAATA,EACrBnH,KAAKkE,YAAYiD,GAAMiB,WAGvBpI,KAAKkE,YAAYiD,GAAMkB,aAG/B,OAAO,KAGfrJ,aAAamD,EAAOyF,GAChB,OAAOjF,EAAU3C,UAAM,OAAQ,GAAQ,YACnC,GAAI4H,EAAMlB,KAAM,CACZ,MAAMN,EAAc,CAChB5G,OAAQ,UACR8I,SAAUV,EACV/H,UAAW,GAGf,OADAG,KAAKwD,aAAa+E,KAAK,YAAanC,IAC7B,EAENjE,EAAMoF,mBACPpF,EAAMoF,kBAAmB,QACnBvH,KAAK4F,yBAAyB,iBAElC5F,KAAK4F,yBAAyB,cACpC5F,KAAKyE,YAAcmD,EACnB,UACU5H,KAAKwI,oBAAoBZ,SACzB5H,KAAK4F,yBAAyB,qBAGpC5F,KAAK8F,WAAWE,aAChBhG,KAAKyE,YAAc,KAEvB,OAAO,KAGfzF,oBAAoB4I,GAChB,OAAOjF,EAAU3C,UAAM,OAAQ,GAAQ,YACnC,MAAME,EAAYC,KAAKC,MACjBqI,EAAeb,EAAM9H,WAAa,EAAI8H,EAAM9H,UAAYE,KAAK0I,gBAAgB,MAC7EtC,EAAc,CAChBkC,SAAUV,GAEd,UACU5H,KAAK8D,mBAAmB6E,KAAK3I,KAAK2D,iBAAiBwE,KAAKP,EAAM/F,SAAU,SAAW+F,EAAMhD,OAAQ6D,GACvGrC,EAAY5G,OAAS,UAEzB,MAAOoJ,GACCA,aAAiB7E,EAAqBpE,aACtCyG,EAAY5G,OAAS,WAGrB4G,EAAY5G,OAAS,OACrB4G,EAAYwC,MAAQA,GAG5BxC,EAAYvG,UAAYM,KAAKC,MAAQF,EACrC,UAEUF,KAAKwD,aAAaqF,yBAAyB,kBAAmBzC,GAExE,MAAOwC,GACHxC,EAAY5G,OAAS,OACrB4G,EAAYwC,MAAQA,EAEG,YAAvBxC,EAAY5G,OACZQ,KAAK8F,WAAWG,iBAEY,YAAvBG,EAAY5G,OACjBQ,KAAK8F,WAAWK,iBAGhBnG,KAAK8F,WAAWI,gBAEZlG,KAAKuD,OAAOxC,kBACZf,KAAK0E,kBAAmB,IAGhC1E,KAAK8F,WAAWM,YAAY/E,KAAK+E,GACjCpG,KAAKwD,aAAa+E,KAAK,YAAanC,MAG5CpH,yBAAyBmI,GACrB,OAAOnH,KAAK8D,mBAAmB6E,KAAK3I,KAAK8I,cAAc3B,GAAOnH,KAAK0I,gBAAgBvB,IAEvFnI,cAAcmI,GACV,OAAOnH,KAAKkE,YAAYiD,GAAM4B,mBAAoBlH,GAAa7B,KAAK2D,iBAAiBwE,KAAKtG,EAAUsF,IAExGnI,gBAAgBmI,GACZ,MAAM6B,EAAUhJ,KAAKuD,OAAOzD,UAC5B,MAA0B,iBAAZkJ,EAAuBA,EAAUA,EAAQ7B,iDC3V/DvI,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,kBAAqB,EAErBF,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOC,EAAaC,0DCDxG,SAASC,EAAUC,EAAGC,GAClB,OAAID,IAAMC,IAGDD,aAAanJ,MAAQoJ,aAAapJ,KAChCmJ,EAAEE,YAAcD,EAAEC,WAEnBC,EAAOH,KAAOG,EAAOF,IAAmB,iBAAND,GAA+B,iBAANC,EAC1DD,IAAMC,EAOrB,SAAyBD,EAAGC,GACxB,IAAI9G,EACAiH,EAOAC,EACAC,EAPJ,IAAKH,EAAOH,KAAOG,EAAOF,GACtB,OAAO,EAEX,GAAID,EAAEO,YAAcN,EAAEM,UAClB,OAAO,EAIX,IACIF,EAAQ/K,OAAOkL,KAAKR,GACpBM,EAAQhL,OAAOkL,KAAKP,GAExB,MAAO7J,GACH,OAAO,EAEX,GAAIiK,EAAMvK,SAAWwK,EAAMxK,OACvB,OAAO,EAIX,IAFAuK,EAAMI,OACNH,EAAMG,OACDtH,EAAIkH,EAAMvK,OAAS,EAAGqD,GAAK,EAAGA,IAC/B,GAAIkH,EAAMlH,KAAOmH,EAAMnH,GACnB,OAAO,EAGf,IAAKA,EAAIkH,EAAMvK,OAAS,EAAGqD,GAAK,EAAGA,IAE/B,GADAiH,EAAMC,EAAMlH,IACP4G,EAAUC,EAAEI,GAAMH,EAAEG,IACrB,OAAO,EAGf,cAAcJ,UAAaC,EAtChBS,CAAgBV,EAAGC,IAwClC,SAASE,EAAO1K,GACZ,OAAOA,MAAAA,EAtDXH,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,iBAAoB,EAepBA,YAAoBuK,6CChBpBzK,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,UAAkBA,aAAgB,EAelCA,QAdA,SAAemC,EAAQC,GACnB,IAAKD,EACD,OAAOC,GAAkB,GAE7B,IAAKA,EACD,OAAOD,EAEX,IAAK,MAAME,KAAQD,GACe,IAA1BD,EAAOG,QAAQD,IACfF,EAAOI,KAAKF,GAGpB,OAAOF,GAaXnC,UAVA,SAAiByC,EAAOJ,GACpB,IAAKI,EACD,MAAO,GAEX,MAAMC,EAAcD,EAAMH,QAAQD,GAIlC,OAHqB,IAAjBK,GACAD,EAAME,OAAOD,EAAa,GAEvBD,oDCzBX3C,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,0BAA6B,EA0D7BA,qBAxDA,MACIE,cACIgB,KAAK0B,YAAc,GACnB1B,KAAK2B,cAAgB,GAEzB3C,GAAG4C,EAAOC,GACL7B,KAAK0B,YAAYE,GAAUqI,EAAajJ,MAAMhB,KAAK0B,YAAYE,GAAQ,CAACC,IAE7E7C,KAAK4C,EAAOC,GACR7B,KAAK2B,cAAcC,GAASqI,EAAajJ,MAAMhB,KAAK2B,cAAcC,GAAQ,CAACC,IAE/E7C,IAAI4C,EAAOC,GACP7B,KAAK0B,YAAYE,GAASqI,EAAa3I,QAAQtB,KAAK0B,YAAYE,GAAQC,GACxE7B,KAAK2B,cAAcC,GAASqI,EAAa3I,QAAQtB,KAAK2B,cAAcC,GAAQC,GAEhF7C,KAAK4C,KAAUE,GACX,GAAI9B,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpCC,EAASE,KAAK,QAASD,GAG/B,GAAI9B,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtCC,EAASE,KAAK,QAASD,GAE3B9B,KAAK2B,cAAcC,GAAS,IAGpC5C,yBAAyB4C,KAAUE,GAC/B,MAAME,EAAW,GACjB,GAAIhC,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAIzC,GAAIM,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAGrCM,KAAK2B,cAAcC,GAAS,GAEhC,OAAOvC,QAAQ4C,IAAID,GAAUrB,KAAMuB,6DCtD3CtD,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,mBAAsB,EA6DtB,SAASoL,EAAeZ,EAAGC,GACvB,OAAID,EAAIC,GACI,EAEHD,EAAIC,EACF,EAGA,EATfzK,cA3DA,MACIE,YAAYmL,EAAUD,EAAgBE,EAAgB,IAClDpK,KAAKuB,MAAQ,GACbvB,KAAKqK,gBAAkBF,GAAWD,EAClC,MAAM9K,EAASgL,EAAchL,OAC7B,IAAK,IAAIqD,EAAI,EAAGA,EAAIrD,EAAQqD,IACxBzC,KAAKsK,OAAOF,EAAc3H,IAGlCzD,UACI,OAAOgB,KAAKuB,MAEhBvC,OAAOoD,GACH,IAAImI,EAAavK,KAAKwK,eAAepI,GAAW,EAChD,MAAMqI,EAAezK,KAAKuB,MAAMnC,OAAS,EACzC,KAAQmL,EAAaE,GAA4E,IAA1DzK,KAAKqK,gBAAgBjI,EAASpC,KAAKuB,MAAMgJ,KAC5EA,IAEJ,IAAIG,EAAQ1K,KAAKuB,MAAMnC,OAEvB,IADAY,KAAKuB,MAAMF,KAAKe,GACTsI,EAAQH,GACXvK,KAAKuB,MAAMmJ,GAAS1K,KAAKuB,QAAQmJ,GAErC1K,KAAKuB,MAAMgJ,GAAcnI,EAE7BpD,OAAOoD,GACH,MAAMmI,EAAavK,KAAKwK,eAAepI,GACvC,OAA8D,IAA1DpC,KAAKqK,gBAAgBrK,KAAKuB,MAAMgJ,GAAanI,IACrC,EAELmI,EAEXvL,OAAOoD,GACH,MAAMsI,EAAQ1K,KAAK2K,OAAOvI,GACtBsI,GAAS,GACT1K,KAAKuB,MAAME,OAAOiJ,EAAO,GAGjC1L,eAAeoD,GACX,IAEIsI,EACAE,EAHAC,EAAO7K,KAAKuB,MAAMnC,OAAS,EAC3B0L,EAAM,EAGV,KAAOD,GAAQC,GAGX,GAFAJ,EAAQK,KAAKC,OAAOH,EAAOC,GAAO,GAClCF,EAAW5K,KAAKqK,gBAAgBrK,KAAKuB,MAAMmJ,GAAQtI,GAC/CwI,EAAW,EACXE,EAAMJ,EAAQ,MAEb,CAAA,KAAIE,EAAW,GAIhB,OAAOF,EAHPG,EAAOH,EAAQ,EAMvB,OAAOG,iDC1DfjM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,uBAA+BA,mBAAsB,EAErDA,uBAD6B,mBAsB7BA,cAhBA,SAAqBmM,GACjB,GAAe,OAAXA,EACA,MAAO,OAEX,QAAe9F,IAAX8F,EACA,MAAO,YAEX,GAAIA,aAAkBC,OAClB,OAAOD,EAAOE,WAElB,MAAMC,EAdV,SAA2BC,GACvB,MAAMC,EAAiBD,EAAyB,iBAChD,OAAOC,MAAAA,EAAuDA,EAAiB,KAY5DC,CAAkBN,GACrC,OAAmB,OAAfG,EACOA,EAAWI,SAEfC,KAAKC,UAAUT,wECtB1BrM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,UAAkBA,eAAuBA,aAAqBA,MAAcA,KAAaA,MAAcA,KAAaA,KAAaA,WAAc,EAY/IA,MATA,WACI,MAAM6M,EAAY,CACdC,YAAa,EACbC,QAAS,KAAM,EACfC,YAAa,IAAM,QACnBC,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,KARA,SAAYC,GACR,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAYlN,EACrC+M,YAAa,IAAM,MAAMI,EAAYC,YAAYpN,MACjDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,KARA,SAAYC,GACR,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAYlN,EACrC+M,YAAa,IAAM,MAAMI,EAAYC,YAAYpN,MACjDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,MARA,SAAaC,GACT,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,GAAalN,EACtC+M,YAAa,IAAM,OAAOI,EAAYC,YAAYpN,MAClDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,MARA,SAAaC,GACT,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,GAAalN,EACtC+M,YAAa,IAAM,OAAOI,EAAYC,YAAYpN,MAClDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAYX7M,KATA,SAAYC,GACR,MAAM4M,EAAY,CACdC,WAAY,EACZC,QAAWI,GAAcG,EAAY/C,UAAUtK,EAAOkN,GACtDH,YAAa,IAAMI,EAAYC,YAAYpN,GAC3CgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,aARA,SAAoBC,GAChB,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAUI,WAAWtN,GAC9C+M,YAAa,IAAM,cAAgB/M,EACnCgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,eARA,SAAsBC,GAClB,MAAM4M,EAAY,CACdE,QAAWI,GAAclN,EAAMuN,KAAKL,GACpCH,YAAa,IAAM/M,EAAMoM,WACzBY,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,UARA,SAAiByN,GACb,MAAMZ,EAAY,CACdE,QAAUI,GAAcM,EAAKN,GAC7BH,YAAa,IAAMS,EAAKpB,WACxBY,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,yGCpFX/M,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,cAAsBA,uBAA+BA,aAAqBA,eAAuBA,UAAkBA,MAAcA,KAAaA,MAAcA,KAAaA,KAAaA,MAAcA,qBAA6BA,cAAsBA,iBAAoB,EAE3QF,OAAOC,eAAeC,EAAS,YAAa,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOkD,EAAY/C,aAEtGzK,OAAOC,eAAeC,EAAS,qBAAsB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOzF,EAAqBC,sBAExH9E,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOsD,EAAcC,eAE1G7N,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBC,OACxG/N,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBE,MACvGhO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBG,MACvGjO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBI,OACxGlO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBK,MACvGnO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBM,OACxGpO,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBO,WAC5GrO,OAAOC,eAAeC,EAAS,eAAgB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBQ,gBACjHtO,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBL,cAE/GzN,OAAOC,eAAeC,EAAS,uBAAwB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOgD,EAAYiB,wBACjHvO,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOgD,EAAYC,yMCpBxGvN,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,cAAiB,EAEjB,MAAMsO,UAAuB3N,MACzBT,YAAYqO,EAAYC,GAEpBvN,MADgBuN,EAAeD,EAAa,KAAOC,EAAeD,IAI1E,MAAME,EACFvO,YAAYwO,IAEZxO,aAAayO,EAAUC,EAAQ9N,GAC3B,IAAI+N,EAAatE,UAAUoE,EAAUC,GAGrC,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,sBAA2BC,EAAaxB,YAAYsB,KAAa7N,GAEnIZ,gBAAgByO,EAAUC,EAAQ9N,GAC9B,GAAK+N,EAAatE,UAAUoE,EAAUC,GAGtC,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,0BAA+BC,EAAaxB,YAAYsB,KAAa7N,GAEvIZ,kBAAkB0O,EAAQD,EAAU7N,GAChC,GAAI6N,GAAYC,EAGhB,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,SAAcC,EAAaxB,YAAYsB,KAAa7N,GAEtHZ,qBAAqB0O,EAAQD,EAAU7N,GACnC,GAAI6N,GAAYC,EAGhB,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,SAAcC,EAAaxB,YAAYsB,KAAa7N,GAEtHZ,mBAAmB0O,EAAQD,EAAU7N,GACjC,IAAIhB,OAAOgP,GAAGH,EAAUC,GAGxB,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,wBAA6BC,EAAaxB,YAAYsB,KAAa7N,GAErIZ,sBAAsB0O,EAAQD,EAAU7N,GACpC,GAAKhB,OAAOgP,GAAGH,EAAUC,GAGzB,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,4BAAiCC,EAAaxB,YAAYsB,KAAa7N,GAEzIZ,UAAU0O,EAAQD,EAAU7N,GACxB2N,EAAOM,YAAYH,EAAQD,EAAU7N,GAEzCZ,WAAW8O,EAAQC,EAASN,EAAU7N,GAClC2N,EAAO9D,OAAOqE,EAAQ,UACtBP,EAAO9D,OAAOsE,EAAS,WACvBR,EAAO9D,OAAOqE,EAAQ,UACtB,MAAME,EAAYD,EAAQE,MAAM,KAChC,IAAIzO,EAASsO,EACb,IAAK,MAAMI,KAAQF,EAAW,CAC1B,MAAMG,EAAY3O,EAAO0O,GACpBC,GACDZ,EAAOa,KAAK,gBAAgBF,gBAAmBP,EAAaxB,YAAY3M,uBAA4BmO,EAAaxB,YAAYvN,OAAOkL,KAAK2D,OAE7IjO,EAAS2O,EAEbZ,EAAOM,YAAYrO,EAAQiO,EAAU7N,GAEzCZ,oBAAoB0O,EAAQD,EAAU7N,GAClC,IAAI6N,EAASnB,KAAKoB,GAGlB,MAAM,IAAIN,EAAe,YAAYO,EAAaxB,YAAYuB,yBAA8BC,EAAaxB,YAAYsB,KAAa7N,GAEtIZ,kBAAkB0O,EAAQD,EAAU7N,GAChC,OAAO8N,EACF/M,KAAM0N,IACPd,EAAOe,MAAMD,EAAaZ,IAC1B/N,IACA,MAAM,IAAI0N,EAAe,8DAA8D1N,MAAOE,KAGtGZ,eAAe0O,EAAQD,EAAU7N,GAC7B,MAAM2O,EAAed,aAAoBhO,MAAQgO,EAAS7N,QAAU6N,EACpE,OAAOC,EACF/M,KAAK,KACN,MAAM,IAAIyM,EAAe,gDAAiDxN,IAC1EF,IACI6O,GACAhB,EAAOe,MAAMC,EAAc7O,EAAEE,WAIzCZ,YAAYY,GACR,MAAM,IAAIwN,EAAe,cAAexN,GAE5CZ,cAAcD,EAAOa,GACjB2N,EAAOe,OAAM,EAAMvP,EAAOa,GAE9BZ,eAAeD,EAAOa,GAClB2N,EAAOe,OAAM,EAAOvP,EAAOa,GAE/BZ,gBAAgBD,EAAOa,GACnB,IAAKb,EACD,MAAM,IAAIqO,EAAe,YAAYrO,iBAAsBa,GAGnEZ,eAAeD,EAAOa,GAClB,GAAIb,EACA,MAAM,IAAIqO,EAAe,YAAYrO,gBAAqBa,GAGlEZ,cAAcyO,EAAU7N,GAGpB,OAFAI,KAAKwO,SAASf,EAAU,KAAM,YAAYE,EAAaxB,YAAYsB,sBAA6B7N,KAChGI,KAAKwO,SAASf,OAAUtI,EAAW,YAAYwI,EAAaxB,YAAYsB,2BAAkC7N,MACnG,EAEXZ,gBAAgB8O,EAAQ/O,EAAOa,GAE3B,GADAI,KAAKyJ,OAAOqE,GACU,iBAAXA,EACPP,EAAOkB,QAAkC,IAA3BX,EAAO1M,QAAQrC,GAAe,WAAWA,sBAA0B+O,UAEhF,GAAIY,MAAMC,QAAQb,GACnBP,EAAOkB,QAAkC,IAA3BX,EAAO1M,QAAQrC,GAAe,GAAG4O,EAAaxB,YAAYpN,oCAAwC4O,EAAaxB,YAAY2B,OAAYlO,MAAAA,EAAyCA,EAAU,WAGxM,IAAK,MAAOgP,EAAUC,KAAejQ,OAAOkQ,QAAQ/P,GAChDwO,EAAOe,MAAMR,EAAOc,GAAWC,GAI3C7P,mBAAmB8O,EAAQiB,EAAQnP,GAC/BI,KAAKyJ,OAAOqE,GACZ9N,KAAKyJ,OAAOsF,GACZ,IAAK,MAAMhQ,KAASgQ,EAChBxB,EAAOyB,SAASlB,EAAQ/O,EAAOa,GAGvCZ,2BAA2BiQ,IAE3BjQ,6BAA6BiQ,EAAUC,KAG3CpQ,SAAiByO,0CC7IjB3O,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,SAAiBA,cAAiB,EAElC,MAAMqQ,EACFnQ,YAAY8O,GACR9N,KAAK8N,OAASA,EAElB9O,KAAKD,GACDqQ,EAAS7B,OAAOe,MAAMtO,KAAK8N,OAAQ/O,GAEvCC,eAAe+O,EAAShP,GACpBqQ,EAAS7B,OAAO8B,IAAIrP,KAAK8N,OAAQC,EAAShP,GAE9CC,aACIoQ,EAAS7B,OAAO+B,SAAStP,KAAK8N,QAElC9O,YACIoQ,EAAS7B,OAAOgC,QAAQvP,KAAK8N,SAGrChP,SAAiBqQ,EAIjBrQ,SAHA,SAAgBgP,GACZ,OAAO,IAAIqB,EAAOrB,qDCtBtBlP,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,SAAiBA,SAAiBA,cAAiB,EAEnDF,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOkG,EAAS7B,UAEhG3O,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOsG,EAASL,UAChGvQ,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOsG,EAASC,oECJhG,SAASpG,EAAUC,EAAGC,GAClB,OAAID,IAAMC,IAGDD,aAAanJ,MAAQoJ,aAAapJ,KAChCmJ,EAAEE,YAAcD,EAAEC,WAEnBC,EAAOH,KAAOG,EAAOF,IAAmB,iBAAND,GAA+B,iBAANC,EAC1DD,IAAMC,EAOrB,SAAyBD,EAAGC,GACxB,IAAI9G,EACAiH,EAOAC,EACAC,EAPJ,IAAKH,EAAOH,KAAOG,EAAOF,GACtB,OAAO,EAEX,GAAID,EAAEO,YAAcN,EAAEM,UAClB,OAAO,EAIX,IACIF,EAAQ/K,OAAOkL,KAAKR,GACpBM,EAAQhL,OAAOkL,KAAKP,GAExB,MAAO7J,GACH,OAAO,EAEX,GAAIiK,EAAMvK,SAAWwK,EAAMxK,OACvB,OAAO,EAIX,IAFAuK,EAAMI,OACNH,EAAMG,OACDtH,EAAIkH,EAAMvK,OAAS,EAAGqD,GAAK,EAAGA,IAC/B,GAAIkH,EAAMlH,KAAOmH,EAAMnH,GACnB,OAAO,EAGf,IAAKA,EAAIkH,EAAMvK,OAAS,EAAGqD,GAAK,EAAGA,IAE/B,GADAiH,EAAMC,EAAMlH,IACP4G,EAAUC,EAAEI,GAAMH,EAAEG,IACrB,OAAO,EAGf,cAAcJ,UAAaC,EAtChBS,CAAgBV,EAAGC,IAwClC,SAASE,EAAO1K,GACZ,OAAOA,MAAAA,EAtDXH,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,iBAAoB,EAepBA,YAAoBuK,6CChBpBzK,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,UAAkBA,aAAgB,EAelCA,QAdA,SAAemC,EAAQC,GACnB,IAAKD,EACD,OAAOC,GAAkB,GAE7B,IAAKA,EACD,OAAOD,EAEX,IAAK,MAAME,KAAQD,GACe,IAA1BD,EAAOG,QAAQD,IACfF,EAAOI,KAAKF,GAGpB,OAAOF,GAaXnC,UAVA,SAAiByC,EAAOJ,GACpB,IAAKI,EACD,MAAO,GAEX,MAAMC,EAAcD,EAAMH,QAAQD,GAIlC,OAHqB,IAAjBK,GACAD,EAAME,OAAOD,EAAa,GAEvBD,oDCzBX3C,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,0BAA6B,EA0D7BA,qBAxDA,MACIE,cACIgB,KAAK0B,YAAc,GACnB1B,KAAK2B,cAAgB,GAEzB3C,GAAG4C,EAAOC,GACL7B,KAAK0B,YAAYE,GAAUqI,EAAajJ,MAAMhB,KAAK0B,YAAYE,GAAQ,CAACC,IAE7E7C,KAAK4C,EAAOC,GACR7B,KAAK2B,cAAcC,GAASqI,EAAajJ,MAAMhB,KAAK2B,cAAcC,GAAQ,CAACC,IAE/E7C,IAAI4C,EAAOC,GACP7B,KAAK0B,YAAYE,GAASqI,EAAa3I,QAAQtB,KAAK0B,YAAYE,GAAQC,GACxE7B,KAAK2B,cAAcC,GAASqI,EAAa3I,QAAQtB,KAAK2B,cAAcC,GAAQC,GAEhF7C,KAAK4C,KAAUE,GACX,GAAI9B,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpCC,EAASE,KAAK,QAASD,GAG/B,GAAI9B,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtCC,EAASE,KAAK,QAASD,GAE3B9B,KAAK2B,cAAcC,GAAS,IAGpC5C,yBAAyB4C,KAAUE,GAC/B,MAAME,EAAW,GACjB,GAAIhC,KAAK0B,YAAYE,GACjB,IAAK,MAAMC,KAAY7B,KAAK0B,YAAYE,GACpC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAIzC,GAAIM,KAAK2B,cAAcC,IAAU5B,KAAK2B,cAAcC,GAAOxC,OAAS,EAAG,CACnE,IAAK,MAAMyC,KAAY7B,KAAK2B,cAAcC,GACtC,IACII,EAASX,KAAKhC,QAAQC,QAAQuC,EAASE,KAAK,QAASD,KAEzD,MAAOpC,GACHsC,EAASX,KAAKhC,QAAQE,OAAOG,IAGrCM,KAAK2B,cAAcC,GAAS,GAEhC,OAAOvC,QAAQ4C,IAAID,GAAUrB,KAAMuB,6DCtD3CtD,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,mBAAsB,EA6DtB,SAASoL,EAAeZ,EAAGC,GACvB,OAAID,EAAIC,GACI,EAEHD,EAAIC,EACF,EAGA,EATfzK,cA3DA,MACIE,YAAYmL,EAAUD,EAAgBE,EAAgB,IAClDpK,KAAKuB,MAAQ,GACbvB,KAAKqK,gBAAkBF,GAAWD,EAClC,MAAM9K,EAASgL,EAAchL,OAC7B,IAAK,IAAIqD,EAAI,EAAGA,EAAIrD,EAAQqD,IACxBzC,KAAKsK,OAAOF,EAAc3H,IAGlCzD,UACI,OAAOgB,KAAKuB,MAEhBvC,OAAOoD,GACH,IAAImI,EAAavK,KAAKwK,eAAepI,GAAW,EAChD,MAAMqI,EAAezK,KAAKuB,MAAMnC,OAAS,EACzC,KAAQmL,EAAaE,GAA4E,IAA1DzK,KAAKqK,gBAAgBjI,EAASpC,KAAKuB,MAAMgJ,KAC5EA,IAEJ,IAAIG,EAAQ1K,KAAKuB,MAAMnC,OAEvB,IADAY,KAAKuB,MAAMF,KAAKe,GACTsI,EAAQH,GACXvK,KAAKuB,MAAMmJ,GAAS1K,KAAKuB,QAAQmJ,GAErC1K,KAAKuB,MAAMgJ,GAAcnI,EAE7BpD,OAAOoD,GACH,MAAMmI,EAAavK,KAAKwK,eAAepI,GACvC,OAA8D,IAA1DpC,KAAKqK,gBAAgBrK,KAAKuB,MAAMgJ,GAAanI,IACrC,EAELmI,EAEXvL,OAAOoD,GACH,MAAMsI,EAAQ1K,KAAK2K,OAAOvI,GACtBsI,GAAS,GACT1K,KAAKuB,MAAME,OAAOiJ,EAAO,GAGjC1L,eAAeoD,GACX,IAEIsI,EACAE,EAHAC,EAAO7K,KAAKuB,MAAMnC,OAAS,EAC3B0L,EAAM,EAGV,KAAOD,GAAQC,GAGX,GAFAJ,EAAQK,KAAKC,OAAOH,EAAOC,GAAO,GAClCF,EAAW5K,KAAKqK,gBAAgBrK,KAAKuB,MAAMmJ,GAAQtI,GAC/CwI,EAAW,EACXE,EAAMJ,EAAQ,MAEb,CAAA,KAAIE,EAAW,GAIhB,OAAOF,EAHPG,EAAOH,EAAQ,EAMvB,OAAOG,iDC1DfjM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,uBAA+BA,mBAAsB,EAErDA,uBAD6B,mBAO7B,SAAS4Q,EAAYzE,GACjB,MAAsB,iBAAXA,GAAyC,iBAAXA,EAC9B0E,OAAO1E,GAEX,IAAI0E,OAAO1E,GAAQ2E,QAAQ,KAAM,OAAQA,QAAQ,QAAS,OAAOA,QAAQ,MAAO,OAAOA,QAAQ,MAAO,UAsDjH9Q,cApDA,SAAqBmM,GACjB,MAAM4E,EAAqB,GACrBC,EAAqB,CAACC,EAAgBC,EAT1B,QAUd,GAAuB,OAAnBD,EACA,MAAO,OAEX,QAAuB5K,IAAnB4K,EACA,MAAO,YAEX,GAAIA,aAA0B7E,OAC1B,OAAO6E,EAAe5E,WAE1B,GAAI4E,aAA0B5P,KAC1B,MAAO,aAAa4P,EAAeE,kBAEvC,GAAIF,aAA0BtQ,MAC1B,MAAO,aAAasQ,EAAenQ,WAEvC,IAAoD,IAAhDiQ,EAAmBzO,QAAQ2O,GAC3B,MAAO,gCAEX,MAAM3E,EAhCd,SAA2BC,GACvB,MAAMC,EAAiBD,EAAyB,iBAChD,OAAOC,MAAAA,EAAuDA,EAAiB,KA8BxDC,CAAkBwE,GACrC,GAAmB,OAAf3E,EACA,OAAOA,EAAWI,SAEtB,MAAM0E,SAAsBH,EAC5B,GAAqB,aAAjBG,GAAgD,YAAjBA,GAA+C,WAAjBA,GAA8C,WAAjBA,EAC1F,OAAOP,OAAOI,GAElB,GAAIrB,MAAMC,QAAQoB,GAAiB,CAC/B,MAAMI,EAAY,GAClBN,EAAmBxO,KAAK0O,GACxB,IAAK,MAAM5O,KAAQ4O,EACfI,EAAU9O,KAAK,GAAG2O,IAASF,EAAmB3O,EAAM6O,EAxC9C,SA2CV,OADAH,EAAmBtN,MACZ,MAAM4N,EAAUC,KAAK,WAAWJ,EAAOK,OA3CpC,KA2CyDjR,WAEvE,GAAI2Q,aAA0BnR,OAAQ,CAClCiR,EAAmBxO,KAAK0O,GACxB,MAAMjG,EAAOwG,QAAQC,QAAQR,GACvBS,EAAa,GACnB,IAAK,MAAM9G,KAAOI,EACd0G,EAAWnP,KAAK,GAAG2O,IAASN,EAAYhG,OAASoG,EAAmBQ,QAAQpH,IAAI6G,EAAgBrG,GAAMsG,EAlDhG,SAqDV,OADAH,EAAmBtN,MACZ,MAAMiO,EAAWJ,KAAK,WAAWJ,EAAOK,OArDrC,KAqD0DjR,WAExE,OAAOsQ,EAAYK,IAEvB,OAAOD,EAAmB7E,wECjE9BrM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,UAAkBA,eAAuBA,aAAqBA,MAAcA,KAAaA,MAAcA,KAAaA,KAAaA,WAAc,EAY/IA,MATA,WACI,MAAM6M,EAAY,CACdC,YAAa,EACbC,QAAS,KAAM,EACfC,YAAa,IAAM,QACnBC,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,KARA,SAAYC,GACR,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAYlN,EACrC+M,YAAa,IAAM,MAAMI,EAAYC,YAAYpN,MACjDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,KARA,SAAYC,GACR,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAYlN,EACrC+M,YAAa,IAAM,MAAMI,EAAYC,YAAYpN,MACjDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,MARA,SAAaC,GACT,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,GAAalN,EACtC+M,YAAa,IAAM,OAAOI,EAAYC,YAAYpN,MAClDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,MARA,SAAaC,GACT,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,GAAalN,EACtC+M,YAAa,IAAM,OAAOI,EAAYC,YAAYpN,MAClDgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAYX7M,KATA,SAAYC,GACR,MAAM4M,EAAY,CACdC,WAAY,EACZC,QAAWI,GAAcG,EAAY/C,UAAUtK,EAAOkN,GACtDH,YAAa,IAAMI,EAAYC,YAAYpN,GAC3CgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,aARA,SAAoBC,GAChB,MAAM4M,EAAY,CACdE,QAAWI,GAAcA,EAAUI,WAAWtN,GAC9C+M,YAAa,IAAM,cAAgB/M,EACnCgN,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,eARA,SAAsBC,GAClB,MAAM4M,EAAY,CACdE,QAAWI,GAAclN,EAAMuN,KAAKL,GACpCH,YAAa,IAAM/M,EAAMoM,WACzBY,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,GAWX7M,UARA,SAAiByN,GACb,MAAMZ,EAAY,CACdE,QAAUI,GAAcM,EAAKN,GAC7BH,YAAa,IAAMS,EAAKpB,WACxBY,OAASC,GAAUA,EAAMF,gBAAkBH,EAAUG,eAEzD,OAAOH,yGCpFX/M,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,cAAsBA,uBAA+BA,aAAqBA,eAAuBA,UAAkBA,MAAcA,KAAaA,MAAcA,KAAaA,KAAaA,MAAcA,qBAA6BA,cAAsBA,iBAAoB,EAE3QF,OAAOC,eAAeC,EAAS,YAAa,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOkD,EAAY/C,aAEtGzK,OAAOC,eAAeC,EAAS,qBAAsB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOzF,EAAqBC,sBAExH9E,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOsD,EAAcC,eAE1G7N,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBC,OACxG/N,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBE,MACvGhO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBG,MACvGjO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBI,OACxGlO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBK,MACvGnO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBM,OACxGpO,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBO,WAC5GrO,OAAOC,eAAeC,EAAS,eAAgB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBQ,gBACjHtO,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwD,EAAoBL,cAE/GzN,OAAOC,eAAeC,EAAS,uBAAwB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOgD,EAAYiB,wBACjHvO,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOgD,EAAYC,yMCpBxGvN,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,kBAAqB,EACrB,MAAM2R,EACFzR,cACIgB,KAAKiC,IAAM,GAEfyO,YACI,OAAwB,IAApB1Q,KAAKiC,IAAI7C,OACF,KAEJY,KAAKiC,IAAI,GAEpB0O,WACI,OAAwB,IAApB3Q,KAAKiC,IAAI7C,OACF,KAEJY,KAAKiC,IAAIjC,KAAKiC,IAAI7C,OAAS,GAEtCJ,QAAQ4R,GAEJ,OADA5Q,KAAKiC,IAAIZ,KAAKuP,IACP,EAEX5R,cACI,OAAwB,IAApBgB,KAAKiC,IAAI7C,OACF,yCAEJ,6CAA+CY,KAAKiC,IAE/DjD,OAAOgN,GACH,OAAIA,aAAiByE,GACVzE,EAAM/J,MAAQjC,KAAKiC,KAQtCnD,aAHA,WACI,OAAO,IAAI2R,+CChCf,IAAII,EAOJ,SAASC,EAAsBzF,GAC3B,GAAIA,MAAAA,EACA,OAAO,KAEX,MAAMC,EAAiBD,EAAKsC,EAAaR,sBACzC,OAAO7B,MAAAA,EAAuDA,EAAiB,KAWnF,SAASyF,EAAuB9F,GAC5B,OAAO,IAAIxL,MAAM,0DAA0DkO,EAAaxB,YAAYlB,IA5BxGrM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,WAAmBA,uBAA+BA,yBAAiCA,wBAAgCA,oBAA4BA,4BAA+B,EAE9KF,OAAOC,eAAeC,EAAS,uBAAwB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaR,wBAElH,SAAW0D,GACPA,EAASA,EAAmB,SAAI,GAAK,WACrCA,EAASA,EAAiB,OAAI,GAAK,SACnCA,EAASA,EAAkB,QAAI,GAAK,UAHxC,CAIGA,IAAaA,EAAW,KAC3B/R,WAAmB+R,EAQnB/R,wBAAgCgS,EAQhChS,oBAPA,SAA2BuM,GACvB,MAAMC,EAAiBwF,EAAsBzF,GAC7C,GAAuB,OAAnBC,EACA,MAAMyF,EAAuB1F,GAEjC,OAAOC,GAMXxM,yBAAiCiS,EAejCjS,uBAdA,SAA8BkS,EAAgBC,EAAczF,EAAUtG,EAASgM,GAC3E,MAAM5F,EAAiB,CACnB6F,aAAc,GACdC,oBAAqB,GACrBH,aAAcA,EACd/L,QAASA,EACTmM,kBAAmB,GACnBC,iBAAiB,EACjB9F,SAAUA,MAAAA,EAA2CA,EAAW,OAChE0F,SAAUA,GAGd,OADAF,EAAerD,EAAaR,sBAAwB7B,EAC7CA,gKC3CX1M,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,uBAA0B,EAgC1BA,kBA/BA,MACIE,8BAA8BuS,GAC1B,MAAMC,GAAa,IAAI/R,OAAQ4C,MAC/B,QAAmB8C,IAAfqM,EACA,OAAO,KAEX,MAAMC,EAAkBD,EAAWvD,MAAM,MACnC7O,EAASqS,EAAgBrS,OAC/B,GAAIA,EAASmS,EAAQ,EACjB,OAAO,KAEX,IAAI9O,EAAI,EACJiP,EAAkB,KACtB,KAAOjP,EAAIrD,EAAQqD,IAEf,GADAiP,EAAkBD,EAAgBhP,GAC9B,2CAA2C6J,KAAKoF,GAAkB,CAClEjP,IACAiP,EAAkBD,EAAgBhP,GAClC,MAGR,GAAwB,OAApBiP,EACA,OAAO,KAEX,MAAM7F,EAAU,eAAe1D,KAAKuJ,GACpC,OAAgB,OAAZ7F,EACO,KAEJA,EAAQ,sDCxBvB,SAAS8F,EAAwBR,EAAcrP,GAC3C,MAAM8P,EAAuB,IAAIjE,EAAalB,YAAY,CAACnD,EAAGC,KAC1D,QAAUpE,IAANmE,QAAyBnE,IAANoE,EACnB,OAAO,EAEN,QAAUpE,IAANmE,EACL,OAAO,EAEN,QAAUnE,IAANoE,EACL,OAAQ,EAEZ,GAA0B,OAAtBD,EAAEuI,iBAAiD,MAArBtI,EAAEsI,gBAChC,OAAQ,EAEZ,GAA0B,OAAtBvI,EAAEuI,iBAAkD,OAAtBtI,EAAEsI,gBAChC,OAAO,EAEX,GAAuB,OAAnBvI,EAAEwI,cAA4C,OAAnBvI,EAAEuI,aAC7B,OAAO,EAEN,GAAuB,OAAnBxI,EAAEwI,aACP,OAAO,EAEN,GAAuB,OAAnBvI,EAAEuI,aACP,OAAQ,EAEZ,MAAMC,EAAsBxI,EAAEuI,aAAa1S,OAASkK,EAAEwI,aAAa1S,OACnE,GAA4B,IAAxB2S,EACA,OAAOA,EAEX,MAAMC,EAAqBC,EAAY3I,EAAEwI,cAEzC,OAD2BG,EAAY1I,EAAEuI,cACbE,IAEhC,IAAK,MAAME,KAAef,EACtBS,EAAqBtH,OAAO4H,GAEhC,IAAK,MAAMA,KAAeN,EAAqBO,UAAW,CACtD,GAAID,EAAYE,WAAaF,EAAYG,cAAcC,IACnD,SAIJ,GADgBC,EADKL,EAAYJ,aACmBhQ,GAEhD,OAAOoQ,EAGf,OAAO,KAGX,SAASD,EAAYH,GACjB,IAAIU,EAAM,EACV,IAAK,MAAM5B,KAAOkB,EACdU,QAA0BrN,IAAnByL,EAAIhF,WAA2BgF,EAAIhF,WAAa,EAE3D,OAAO4G,EAEX,SAASD,EAAsBT,EAAchQ,GACzC,GAAqB,OAAjBgQ,EACA,OAAO,EAEX,GAAIhQ,EAAK1C,OAAS0S,EAAa1S,OAC3B,OAAO,EAEX,IAAIqT,GAAU,EACc,IAAxBX,EAAa1S,SACbqT,EAA0B,IAAhB3Q,EAAK1C,QAEnB,IAAK,IAAIqD,EAAI,EAAGA,EAAIqP,EAAa1S,OAAQqD,IAAK,CAC1C,MAAMiQ,EAAoBZ,EAAarP,GACjCmO,EAAM9O,EAAKW,GACjBgQ,EAAUA,GAAWC,EAAkB7G,QAAQ+E,GAEnD,OAAO6B,EA/EX7T,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,wBAAgCA,0BAAkCA,4BAA+B,EAsDjGA,0BAAkC6S,EA0BlC7S,wBAAgCyT,EAChC,MAAMI,EAA4B,CAAEC,iBAAiB,GACrD,SAASC,EAAuBX,EAAahN,EAAUyN,GAEnD,IAAIG,EAAa,MADMZ,EAAY5G,eAAeE,UAAY,QAE9D,GAAiC,OAA7B0G,EAAYJ,aACZgB,GAAc,4BAEb,CACD,MAAMC,EAAU,GAChB,IAAK,MAAMC,KAAwBd,EAAYJ,aACvCkB,EAAqBlH,YACrBiH,EAAQ1R,KAAK2R,EAAqBlH,eAGlCiH,EAAQ1R,KAAK2R,EAAqB7H,YAG1C2H,GAAc,IAAIC,EAAQ3C,KAAK,SAMnC,OAJA0C,GAAc,cAAcZ,EAAYG,cAAcY,2BAA2Bf,EAAYE,aACzFlN,EAAQ0N,kBACRE,GAAc,0BAA0BZ,EAAYgB,UAEjDJ,EAAa,KAmExBhU,uBAjEA,WACI,MA6DMqU,EA7DO,YAAarR,GACtB,MAAMwJ,EAAiB8H,EAAiBC,kBAAkBF,GACpDG,EAAkBC,EAAmBC,gBAAgBC,uBAAuB,GAClFnI,EAAe8F,oBAAoB/P,KAAK,CACpCqS,OAAQ5R,EACRoR,SAAUI,IAEd,MAAMK,EAAkBhC,EAAwBrG,EAAe6F,aAAcrP,GAC7E,GAAwB,OAApB6R,EAA0B,CAC1B,GAAIA,EAAgB9B,gBAAiB,CACjC,MAAMA,EAAkB8B,EAAgB9B,gBAClC+B,EAAqB/B,EAAgBV,aAAaU,EAAgBgC,cACxE,GAAID,IAAuBD,EAAiB,CACxC,MAAMG,EAA2BjB,EAAuBe,GACxD,MAAM,IAAInU,MAAM,yCAAyCqU,eACzCjB,EAAuBc,EAAiB,CAAEf,iBAAiB,IACvE,eAAeU,GAOnB,GAJqC,IAAjCzB,EAAgBgC,cAChBvI,EAAe+F,kBAAkBhQ,KAAKwQ,GAE1CA,EAAgBgC,eACZhC,EAAgBgC,aAAehC,EAAgBV,aAAa/R,OAAQ,CACpE,MAAM2U,EAAkBzI,EAAe+F,kBAAkBjQ,QAAQyQ,GACjE,IAAyB,IAArBkC,EACA,MAAM,IAAItU,MAAM,oCAEpB6L,EAAe+F,kBAAkB5P,OAAOsS,EAAiB,SAIhE,GAAIzI,EAAe+F,kBAAkBjS,OAAS,EAC/C,MAAM,IAAIK,MAAM,6BAGpB,GADAkU,EAAgBvB,aACXuB,EAAgBK,OACjB,OAGJ,OADeL,EAAgBK,UAAUlS,GAG7C,GAAIwJ,EAAe4F,WAAakC,EAAiBvC,SAASoD,QACtD,OAAO3I,EAAe2F,aAAa5N,MAAMrD,KAAM8B,GAEnD,GAAIwJ,EAAepG,QAAQgP,aAAeC,EAAOC,eAAeC,OAAQ,CACpE,IAAIlD,EAAe,GACnB,IAAK,MAAMe,KAAe5G,EAAe6F,aACrCA,GAAgB0B,EAAuBX,GAAe,KAE1Df,EAAeA,EAAe,oBAAoBA,KAAuB,GACzE,MAAMmD,EAAUhJ,EAAe6F,aAAa/R,OAAS,EAAI,UAAY,UAC/DmV,EAAkB,GACxB,IAAK,MAAM3D,KAAO9O,EACdyS,EAAgBlT,KAAKsM,EAAaxB,YAAYyE,IAElD,MAAM4D,EAAWD,EAAgBnE,KAAK,MACtC,MAAM,IAAI3Q,MAAM,GAAG0T,EAAWjU,QAAQsV,oCAA2CF,KAAWnD,KAEhG,OAAO,MAGX,OAAOgC,2GC1KXvU,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,aAAgB,EAkChBA,QAjCA,MACIE,YAAYyV,EAAOnC,EAAMmC,GACrB,GAAIA,EAAQ,EACR,MAAM,IAAIhV,MAAM,sCAAsCgV,GAE1D,GAAInC,EAAM,EACN,MAAM7S,MAAM,oCAAoC6S,GAEpD,GAAImC,EAAQnC,EACR,MAAM,IAAI7S,MAAM,gCAAgCgV,UAAcnC,KAElEtS,KAAKyU,MAAQA,EACbzU,KAAKsS,IAAMA,EAEftT,eACI,OAAOgB,KAAKyU,QAAUzU,KAAKsS,IAE/BtT,UAAU0V,GACN,OAAOA,GAAS1U,KAAKyU,OAASC,GAAS1U,KAAKsS,IAEhDtT,kBACI,OAAOgB,KAAKsS,MAAQqC,OAAOC,iBAE/B5V,gBACI,OAAIgB,KAAK6U,eACK7U,KAAKyU,MAAR,eAEPzU,KAAK8U,kBACE,YAAY9U,KAAKyU,oBAErB,WAAWzU,KAAKyU,aAAazU,KAAKsS,2DCzBjD,SAASyC,EAAyBhW,GAC9B,OAAO,WACH,OAAOA,GAGf,SAASiW,EAAwBpM,GAC7B,OAAO,WACH,MAAMA,GAQd,SAASqM,EAA2BlW,GAChC,OAAO,WACH,OAAOM,QAAQC,QAAQP,IAG/B,SAASmW,EAA0BtM,GAC/B,OAAO,WACH,OAAOvJ,QAAQE,OAAOqJ,IAG9B,SAASuM,EAAqBrT,GAC1B,MAAMsT,EAAiB,GACvB,IAAK,MAAMxE,KAAO9O,EAAM,CACpB,MAAMuT,EAA6D,OAAhDjC,EAAiBtC,sBAAsBF,IAAwC,mBAAhBA,EAAI/E,QAAyB+E,EAAMjD,EAAaf,GAAGgE,GACrIwE,EAAe/T,KAAKgU,GAExB,OAAOD,EAtCXxW,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,uBAA+BA,oBAAuB,EAuCtDA,uBAA+BqW,EAE/B,MAAMG,UAAqBC,EAAepG,OACtCnQ,YAAYgS,GAQR,GAPAjR,MAAMiR,GACNhR,KAAKwV,aAJG,EAKRxV,KAAKyV,cALG,EAMRzV,KAAK0V,YANG,EAOR1V,KAAKgR,eAAiBA,EACtBhR,KAAKsL,eAAiB8H,EAAiBtC,sBAAsBE,GAC7DhR,KAAK2V,4BAA8B,KAC/B3V,KAAKsL,eAAgB,CACrBtL,KAAKsL,eAAegG,iBAAkB,EACtC,MAAMY,EAAc,CAChB5G,eAAgBtL,KAAKsL,eACrB+G,cAAe,IAAIuD,EAAQC,MAAM,GACjC3C,SAAUK,EAAmBC,gBAAgBC,uBAAuB,GACpEO,OAAQ,KACRlC,aAAc9R,KAAK2V,4BACnBvD,UAAW,EACXP,gBAAiB,MAErB7R,KAAKsL,eAAe6F,aAAa9P,KAAK6Q,GACtClS,KAAKkS,YAAcA,OAGnBlS,KAAKkS,YAAc,KAG3BlT,iBACI,GAAyB,OAArBgB,KAAKkS,YACL,MAAM,IAAIzS,MAAM,kDAEpB,OAAOO,KAAKkS,YAEhBlT,YAAY8C,GACR,GAAyB,OAArB9B,KAAKkS,YACL,MAAM,IAAIzS,MAAM,0EAIpB,OAFAO,KAAK2V,4BAA8BR,EAAqBrT,GACxD9B,KAAKkS,YAAYJ,aAAe9R,KAAK2V,4BAC9B3V,KAEXhB,UAAUD,GACN,GAAyB,OAArBiB,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAGvD,OADAhR,KAAKkS,YAAY8B,OAASe,EAAyBhW,GAC5CiB,KAEXhB,cAAcD,GACV,GAAyB,OAArBiB,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvDhR,KAAKkS,YAAY8B,OAASe,EAAyBhW,GACnDiB,KAAK8V,QAAQ,GAEjB9W,SAAS4J,GACL,GAAyB,OAArB5I,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAGvD,OADAhR,KAAKkS,YAAY8B,OAASgB,EAAwBpM,GAC3C5I,KAEXhB,aAAa4J,GACT,GAAyB,OAArB5I,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvDhR,KAAKkS,YAAY8B,OAASgB,EAAwBpM,GAClD5I,KAAK8V,QAAQ,GAEjB9W,oBACI,GAAyB,OAArBgB,KAAKkS,aAAgD,OAAxBlS,KAAKsL,eAClC,MAAM8H,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvD,MAAMC,EAAejR,KAAKsL,eAAe2F,aACzC,IAAKA,EACD,MAAM,IAAIxR,MAAM,yEAGpB,OADAO,KAAKkS,YAAY8B,OAtGzB,SAAoC/C,GAChC,OAAO,YAA6BnP,GAChC,OAAOmP,EAAanP,IAoGMiU,CAA2B9E,GAC9CjR,KAEXhB,UAAUgV,GACN,GAAyB,OAArBhU,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAGvD,OADAhR,KAAKkS,YAAY8B,OAASA,EACnBhU,KAEXhB,cAAcgV,GACV,GAAyB,OAArBhU,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvDhR,KAAKkS,YAAY8B,OAASA,EAC1BhU,KAAK8V,QAAQ,GAEjB9W,WAAWD,GACP,GAAyB,OAArBiB,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAGvD,OADAhR,KAAKkS,YAAY8B,OAASiB,EAA2BlW,GAC9CiB,KAEXhB,eAAeD,GACX,GAAyB,OAArBiB,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvDhR,KAAKkS,YAAY8B,OAASiB,EAA2BlW,GACrDiB,KAAK8V,QAAQ,GAEjB9W,UAAU4J,GACN,GAAyB,OAArB5I,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAGvD,OADAhR,KAAKkS,YAAY8B,OAASkB,EAA0BtM,GAC7C5I,KAEXhB,cAAc4J,GACV,GAAyB,OAArB5I,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvDhR,KAAKkS,YAAY8B,OAASkB,EAA0BtM,GACpD5I,KAAK8V,QAAQ,GAEjB9W,MAAM0V,GACF,GAAyB,OAArB1U,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvD,IA/HQ,IA+HJhR,KAAK0V,aA/HD,IA+H2B1V,KAAKyV,eA/HhC,IA+H4DzV,KAAKwV,YACrE,MAAM,IAAI/V,MAAM,iEAIpB,OAFAO,KAAK0V,WAAahB,EAClB1U,KAAKgW,iBAAiB,IAAIJ,EAAQC,MAAMnB,IACjC1U,KAEXhB,OACI,OAAOgB,KAAKiW,MAAM,GAEtBjX,QACI,OAAOgB,KAAKiW,MAAM,GAEtBjX,OAAOkX,GACH,GAAyB,OAArBlW,KAAKkS,YACL,MAAMkB,EAAiBrC,uBAAuB/Q,KAAKgR,gBAEvD,IAhJQ,IAgJJhR,KAAK0V,aAhJD,IAgJ4B1V,KAAKwV,aAA2BxV,KAAKwV,cAAgBb,OAAOC,iBAC5F,MAAM,IAAInV,MAAM,iEAKpB,OAHAO,KAAKwV,YAAcU,EACnBlW,KAAKyV,cApJG,IAoJYzV,KAAKyV,aAA2BzV,KAAKyV,aAAe,EACxEzV,KAAKgW,iBAAiB,IAAIJ,EAAQC,MAAM7V,KAAKyV,aAAczV,KAAKwV,cACzDxV,KAEXhB,QAAQmX,GACJ,IAzJQ,IAyJJnW,KAAK0V,aAzJD,IAyJ4B1V,KAAKyV,cAAkD,IAAtBzV,KAAKyV,aACtE,MAAM,IAAIhW,MAAM,iEAKpB,OAHAO,KAAKyV,aAAeU,EACpBnW,KAAKwV,aA7JG,IA6JWxV,KAAKwV,YAA0BxV,KAAKwV,YAAcb,OAAOC,iBAC5E5U,KAAKgW,iBAAiB,IAAIJ,EAAQC,MAAM7V,KAAKyV,aAAczV,KAAKwV,cACzDxV,KAEXhB,iBAAiBoX,GACb,MAAMjF,EAAenR,KAAKsL,eAAe6F,aACzC,GAAIA,EAAa/R,OAAS,GAAKgX,EAAMvB,eAAgB,CACjD,MAAMwB,EAAkBlF,EAAaA,EAAa/R,OAAS,GACrDkX,EAAmBnF,EAAaA,EAAa/R,OAAS,GAC5D,IAAKkX,EAAiBjE,cAAcwC,gBAC5B7U,KAAKuW,iBAAiBD,EAAkBD,GACxC,MAAM,IAAI5W,MAAM,+CAI5BO,KAAKkS,YAAYG,cAAgB+D,EAErCpX,iBAAiBsX,EAAkBD,GAC/B,GAAqC,OAAjCA,EAAgBvE,cAA2D,OAAlCwE,EAAiBxE,aAC1D,OAAyC,OAAlCwE,EAAiBxE,cAA0D,OAAjCuE,EAAgBvE,aAErE,GAAIuE,EAAgBvE,aAAa1S,SAAWkX,EAAiBxE,aAAa1S,OACtE,OAAO,EAEX,IAAK,IAAIqD,EAAI,EAAGA,EAAI4T,EAAgBvE,aAAa1S,OAAQqD,IAAK,CAC1D,MAAM+T,EAAUF,EAAiBxE,aAAarP,GAE9C,IADe4T,EAAgBvE,aAAarP,GAChCsJ,OAAOyK,GACf,OAAO,EAGf,OAAO,GAGf1X,eAAuBwW,uECzNvB,SAASmB,EAAUpL,GACf,MAAMC,EAAiB8H,EAAiBC,kBAAkBhI,GACpDiB,EAAO1N,OAAOkL,KAAKuB,GACzB,IAAK,MAAM3B,KAAO4C,EAAM,CACpB,MAAMvN,EAAQsM,EAAK3B,GACnB,GAAI3K,EAAO,CACwBqU,EAAiBtC,sBAAsB/R,IAElE0X,EAAU1X,IAItBuM,EAAegG,iBAAkB,EACjCoF,EAAWpL,EAAe6F,cAC1BuF,EAAWpL,EAAe+F,mBAC1BqF,EAAWpL,EAAe8F,qBAE9B,SAASsF,EAAWnV,GAChB,KAAOA,EAAMnC,OAAS,GAClBmC,EAAMiB,QAGd,SAASmU,EAAWtL,GAChB,MAAMC,EAAiB8H,EAAiBC,kBAAkBhI,GACpDiB,EAAOgE,QAAQC,QAAQlF,GAC7B,IAAK,MAAM3B,KAAO4C,EAAM,CACpB,MAAMvN,EAAQuR,QAAQpH,IAAImC,EAAM3B,GAChC,GAAI3K,EAAO,CACwBqU,EAAiBtC,sBAAsB/R,IAElE4X,EAAW5X,IAIvB,IAAK,MAAMmT,KAAe5G,EAAe6F,aACrC,IAAKe,EAAYG,cAAcuE,UAAU1E,EAAYE,WACjD,MAAM,IAAI3S,MAAMoX,EAAkBvL,EAAe8F,oBAAqBc,IAIlF,SAAS2E,EAAkB/U,EAAM6R,GAC7B,MAAMmD,EAQV,SAA4BhF,EAAchQ,GACtC,MAAMiV,EAAgB,GACtB,IAAK,MAAMC,KAAclV,EACA,OAAjBgQ,GAC4B,OAAxBkF,EAAW9D,UACX6D,EAAc1V,KAAK2V,EAAW9D,UAI1C,OAAO6D,EAjBiBE,CAAmBtD,EAAgB7B,aAAchQ,GACnEoV,GAIiBd,EAJmBzC,EAAgBtB,cAI5BD,EAJ2CuB,EAAgBvB,UAKlF,YAAYgE,EAAMnD,wBAAwBb,MADrD,IAA2BgE,EAAOhE,EAH9B,MAAM+E,EAAeL,EAAgB1X,OAAS,EAAI,eAAiB0X,EAAgB1G,KAAK,MAAQ,GAChG,MAAO,GAAG8G,mBAAiCvD,EAAgBT,aAAaiE,OA3D5EvY,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,SAAiBA,aAAgB,EAOjCA,SALA,YAAmBsY,GACf,IAAK,MAAM/L,KAAQ+L,EACfT,EAAWtL,IASnBvM,QALA,YAAkBsY,GACd,IAAK,MAAM/L,KAAQ+L,EACfX,EAAUpL,oDCXlBzM,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,oBAAuB,EAEvB,IAAIuY,EAAe,KACnBvY,eAAuBuY,EACvB,MAAMC,EAAkBC,EAAOC,aAC3BF,IACAxY,eAAuBuY,EAAe,GACtCC,EAAgBzQ,GAAG,cAAe,KAC9B,IAAK,MAAMwE,KAAQgM,EACfI,EAASC,OAAOrM,GAEpBvM,eAAuBuY,EAAe,KAE1CC,EAAgBzQ,GAAG,WAAY,KAC3B/H,eAAuBuY,EAAe,KAE1CC,EAAgBzQ,GAAG,cAAe,KAC9B/H,eAAuBuY,EAAe,oDClB9CzY,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,iBAAyBA,oBAA4BA,SAAiBA,aAAqBA,cAAsBA,OAAeA,eAAkB,EAKlJ,MAAM6Y,EAAkB/Y,OAAOiL,UAC/B,IAAIuK,GACJ,SAAWA,GACPA,EAAeA,EAAuB,OAAI,GAAK,SAC/CA,EAAeA,EAAsB,MAAI,GAAK,QAFlD,CAGGA,IAAmBA,EAAiB,KACvCtV,iBAAyBsV,EACzB,MAAMwD,EACF5Y,YAAY6Y,EAAO7G,EAAgB8G,EAAYtM,EAAUtG,EAASgM,GAC9DlR,KAAK+X,eAAiBF,EACtB7X,KAAK8X,WAAaA,EAClB9X,KAAKwL,SAAWA,EAChBxL,KAAKkF,QAAUA,EACflF,KAAKkR,SAAWA,EACM,OAAlBlR,KAAKwL,UACL8E,QAAQzR,eAAeiZ,EAAY,OAAQ,CAAE/Y,MAAOiB,KAAKwL,WAE7DxL,KAAKsL,eAAiB8H,EAAiB4E,qBAAqBhH,EAAgB8G,EAAY9X,KAAKwL,SAAUxL,KAAKkF,QAASlF,KAAKkR,UAE9HlS,MAAM8O,EAAQlL,EAASqV,GACnB,OAAOnK,EAAOzK,MAAMT,EAASqV,GAEjCjZ,UAAU8O,EAAQmK,EAAUC,GACxB,OAAIlY,KAAKkR,WAAakC,EAAiBvC,SAASoD,QACrCkE,EAAY,IAAInY,KAAK8X,cAAcG,IAEvC,GAEXjZ,IAAI8O,EAAQsK,EAAGC,GACX,GAAID,IAAMhF,EAAiBjG,qBACvB,OAAOnN,KAAKsL,eAEhB,IAkBIgN,EAlBArM,EAAYqE,QAAQpH,IAAIlJ,KAAK8X,WAAYM,EAAGC,GAChD,QAAkBlT,IAAd8G,IACyB,mBAAdA,GAA4BjM,KAAKkR,WAAakC,EAAiBvC,SAASoD,SAAiE,OAAtDb,EAAiBtC,sBAAsB7E,IACjI,OAAOA,EAGf,GAAIjM,KAAK+X,qBAAgC5S,IAAd8G,EAAyB,CAChD,MAAMsM,EAAqBvY,KAAKwY,sBAAsBxY,KAAK+X,eAAgBK,GAC3E,QAA2BjT,IAAvBoT,EACAtM,EAAYsM,EAAmBxZ,WAE9B,GAAIiB,KAAKkR,WAAakC,EAAiBvC,SAAS4H,SACjD,OAGJzY,KAAK8X,sBAAsBzY,SAAiB,SAAN+Y,IACtCnM,EAAYA,EAAUyM,KAAK1Y,KAAK8X,aAGpC,MAAMtM,EAA6B,OAAlBxL,KAAKwL,SAAoB,GAAGxL,KAAKwL,YAAY4M,EAAEjN,aAAeiN,EAAEjN,WACjF,OAAQnL,KAAKkR,UACT,KAAKkC,EAAiBvC,SAAS4H,SAC3BH,EAAiBjN,EAAKY,EAAWT,GACjC,MACJ,KAAK4H,EAAiBvC,SAAS8H,OAC/B,KAAKvF,EAAiBvC,SAASoD,QAC3B,IAAKhI,EACD,OAAOA,EAEXqM,EAAiBH,EAAYlM,GAC7B,MACJ,QACI,MAAM,IAAIxM,MAAM,qBAAuB2T,EAAiBvC,SAAS7Q,KAAKkR,WAG9E,OADAZ,QAAQsI,IAAI5Y,KAAK8X,WAAYM,EAAGE,GACzBA,EAEXtZ,eAAe8O,EAAQsK,GACnB,OAAO9H,QAAQuI,eAAe7Y,KAAK8X,WAAYM,GAEnDpZ,IAAI8O,EAAQsK,EAAGrZ,EAAOsZ,GAClB,OAAO/H,QAAQsI,IAAI5Y,KAAK8X,WAAYM,EAAGrZ,EAAOsZ,GAElDrZ,QAAQ8O,GACJ,IAAIgL,EAAmBxI,QAAQC,QAAQzC,GACnC9N,KAAKkR,WAAakC,EAAiBvC,SAAS8H,SAC5CG,EAAmBA,EAAiB9Q,OAAOsI,QAAQC,QAAQvQ,KAAK+X,kBAEpE,MAAMgB,EAAazI,QAAQC,QAAQvQ,KAAK8X,YAClCkB,EAAoBD,EAAW3X,QAAQgS,EAAiBjG,uBACnC,IAAvB6L,GACAD,EAAWtX,OAAOuX,EAAmB,GAEzC,IAAK,MAAMtP,KAAOoP,EACVpP,IAAQ0J,EAAiBjG,uBAGI,IAA7B4L,EAAW3X,QAAQsI,IACnBqP,EAAW1X,KAAKqI,GAGxB,OAAOqP,EAEX/Z,yBAAyB8O,EAAQsK,GAC7B,MAAMa,EAAa3I,QAAQ4I,yBAAyBpL,EAAQsK,GAC5D,YAAmBjT,IAAf8T,EACOA,EAEJ3I,QAAQ4I,yBAAyBlZ,KAAK8X,WAAYM,GAE7DpZ,sBAAsBiM,EAAQkO,GAC1B,IAAKlO,EACD,OAEJ,IAAImO,EAAenO,EACnB,KAAOmO,IAAiBzB,GAAiB,CACrC,MAAMY,EAAqBjI,QAAQ4I,yBAAyBE,EAAcD,GAC1E,QAA2BhU,IAAvBoT,EACA,OAAOA,EAEXa,EAAe9I,QAAQ+I,eAAeD,KAKlD,IAAIE,EAAiB,CACjBpF,WAAYE,EAAeC,OAC3BkF,SAAS,GAMb,SAASlO,EAAKwM,EAAOrM,EAAUtG,EAAUoU,GACrC,MAAME,EAAeC,EAAiBC,uBACjB,iBAAV7B,IACPrM,EAAWqM,EACXA,OAAQ1S,GAEPqG,IACDA,EAAW,MAEf,MAAMmO,EAAQ,IAAIC,MAAMJ,EAAc,IAAI5B,EAAkBC,EAAQA,EAAMhO,UAAY,KAAM2P,EAAcA,EAAchO,EAAUtG,EAASkO,EAAiBvC,SAAS4H,WAIrK,OAHIoB,EAA6BxC,cAC7BwC,EAA6BxC,aAAahW,KAAKsY,GAE5CA,EAQX,SAASxB,EAAYL,EAAYtM,EAAW,KAAMtG,EAAUoU,GACxD,MAAME,EAAsC,mBAAf1B,EAA4B2B,EAAiBC,uBAAyB,GACnG,OAAO,IAAIE,MAAMJ,EAAc,IAAI5B,EAAkBhZ,OAAOya,eAAevB,GAAa0B,EAAc1B,EAAYtM,EAAUtG,EAASkO,EAAiBvC,SAASoD,UAxBnKnV,oBAHA,SAA2BoG,GACvBoU,EAAiB1a,OAAOkb,OAAOR,EAAgBpU,IAkBnDpG,OAAeuM,EAKfvM,aAJA,SAAoB+Y,GAChB,MAAM2B,EAAeC,EAAiBC,uBACtC,OAAO,IAAIE,MAAMJ,EAAc,IAAI5B,EAAkBC,EAAO2B,EAAcA,EAAc,KAAMF,EAAgBlG,EAAiBvC,SAAS8H,UAO5I7Z,cAAsBqZ,EAItBrZ,SAHA,SAAgBkS,GACZ,OAAO,IAAI+I,EAAezE,aAAatE,IAe3ClS,UAZA,YAAoBkb,GAChB,MAAMC,EAAqB,CACvB9I,aAAc,GACd0C,aAAc,GAEZqG,EAAYF,EAClB,IAAK,MAAMG,KAAYD,EAAW,CAC9B,MAAMhI,EAAciI,EAASC,iBAC7BH,EAAmB9I,aAAa9P,KAAK6Q,GACrCA,EAAYL,gBAAkBoI,6HC1KtCrb,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,aAAqBA,UAAkBA,eAAuBA,aAAqBA,MAAcA,KAAaA,MAAcA,KAAaA,KAAaA,MAAcA,oBAA4BA,UAAkBA,SAAiBA,QAAgBA,SAAiBA,aAAqBA,cAAsBA,YAAe,EAE9TF,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAahB,OACjG/N,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaf,MAChGhO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAad,MAChGjO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAab,OACjGlO,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaZ,MAChGnO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaX,OACjGpO,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaV,WACrGrO,OAAOC,eAAeC,EAAS,eAAgB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAaT,gBAC1GtO,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOyE,EAAatB,cAExGzN,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOmR,EAAUC,cAErG1b,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAO1E,UAC9F7Q,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAOoF,WAC/F3a,OAAOC,eAAeC,EAAS,OAAQ,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAO9I,QAC5FzM,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAOgE,eACnGvZ,OAAOC,eAAeC,EAAS,oBAAqB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAOoG,qBACzG3b,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOiL,EAAOqG,cAElG5b,OAAOC,eAAeC,EAAS,QAAS,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOuO,EAASrQ,SAC/FxI,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOuO,EAASC,uNCvBhG9Y,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,aAAqBA,aAAqBA,aAAqBA,iBAAyBA,QAAgBA,eAAuBA,cAAsBA,aAAqBA,UAAkBA,MAAcA,KAAaA,UAAkBA,MAAcA,KAAaA,KAAaA,MAAcA,SAAiBA,OAAeA,SAAiBA,cAAiB,EAGjWF,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOuR,EAAoBrR,cAE/GxK,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOqM,EAAehI,UAEtG3O,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB/N,OACtG/N,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB9N,MACrGhO,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBjL,UACzG7Q,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB7N,MACrGjO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB5N,OACtGlO,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBnB,WAC1G3a,OAAOC,eAAeC,EAAS,KAAM,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB3N,MACrGnO,OAAOC,eAAeC,EAAS,MAAO,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkB1N,OACtGpO,OAAOC,eAAeC,EAAS,UAAW,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBzN,WAC1GrO,OAAOC,eAAeC,EAAS,OAAQ,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBrP,QACvGzM,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBJ,cAC7G1b,OAAOC,eAAeC,EAAS,cAAe,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBvC,eAC9GvZ,OAAOC,eAAeC,EAAS,eAAgB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBxN,gBAC/GtO,OAAOC,eAAeC,EAAS,QAAS,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBtT,SACxGxI,OAAOC,eAAeC,EAAS,iBAAkB,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBH,qBACjH3b,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBrO,cAC7GzN,OAAOC,eAAeC,EAAS,aAAc,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBF,cAC7G5b,OAAOC,eAAeC,EAAS,SAAU,CAAEmK,YAAY,EAAMC,IAAK,WAAc,OAAOwR,EAAkBhD"}